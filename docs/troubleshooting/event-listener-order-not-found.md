 # íŠ¸ëŸ¬ë¸”ìŠˆíŒ…: @TransactionalEventListenerì—ì„œ "ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤" ì—ëŸ¬ í•´ê²°

## ë¬¸ì œ ìƒí™©

ì£¼ë¬¸ ì™„ë£Œ í›„ ì™¸ë¶€ ë°ì´í„° í”Œë«í¼ìœ¼ë¡œ ì£¼ë¬¸ ì •ë³´ë¥¼ ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë˜ ì¤‘, ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì—ì„œ ì£¼ë¬¸ì„ ì¡°íšŒí•  ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.

### ì—ëŸ¬ ë¡œê·¸

```
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì£¼ë¬¸ ì™„ë£Œ ì´ë²¤íŠ¸ ìˆ˜ì‹  - Order ID: cd6994bb-2b1c-498a-b917-98b5943ad863
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì£¼ë¬¸ ì¡°íšŒ ì‹¤íŒ¨, ì¬ì‹œë„ 1/3 - Order ID: cd6994bb...
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì£¼ë¬¸ ì¡°íšŒ ì‹¤íŒ¨, ì¬ì‹œë„ 2/3 - Order ID: cd6994bb...
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì£¼ë¬¸ ì¡°íšŒ ì‹¤íŒ¨, ì¬ì‹œë„ 3/3 - Order ID: cd6994bb...
java.lang.IllegalStateException: ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤. Order ID: cd6994bb-2b1c-498a-b917-98b5943ad863
```

### ì´ˆê¸° ì½”ë“œ

```java
// OrderCompletedEvent.java
public record OrderCompletedEvent(String orderId) {}

// CreateOrderService.java
@Transactional
public OrderResponse create(CreateOrderRequest request) {
    OrderFacade.OrderResult result = orderFacade.createOrder(...);

    // ì´ë²¤íŠ¸ ë°œí–‰ (orderIdë§Œ ì „ë‹¬)
    eventPublisher.publishEvent(new OrderCompletedEvent(result.order().getOrderId()));

    return OrderResponse.from(...);
}

// OrderEventListener.java
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
@Async
public void handleOrderCompleted(OrderCompletedEvent event) {
    // DBì—ì„œ ì£¼ë¬¸ ì¡°íšŒ ì‹œë„
    Order order = orderRepository.findById(event.orderId()).orElse(null);
    // âŒ NULL ë°˜í™˜!
}
```

---

## ì›ì¸ ë¶„ì„

### 1. ì½”ë“œ ì‹¤í–‰ íë¦„

```
UseCase (ë¶„ì‚° ë½)
  â””â”€> DistributedLockAop
      â””â”€> AopForTransaction (@Transactional(REQUIRES_NEW))
          â””â”€> CreateOrderService.create() (@Transactional)
              â”œâ”€> orderRepository.save(order)  // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥
              â””â”€> eventPublisher.publishEvent(orderId)
          [ë©”ì„œë“œ ì¢…ë£Œ]
      [íŠ¸ëœì­ì…˜ ì»¤ë°‹!]
  [@TransactionalEventListener(AFTER_COMMIT) ë°œë™]
      â””â”€> @Asyncë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰
          â””â”€> orderRepository.findById(orderId)
              â””â”€> âŒ NULL ë°˜í™˜
```

### 2. í•µì‹¬ ë¬¸ì œì 

#### ë¬¸ì œ 1: AopForTransactionì˜ REQUIRES_NEW

```java
@Transactional(propagation = Propagation.REQUIRES_NEW)
public Object proceed(ProceedingJoinPoint joinPoint) {
    Object result = joinPoint.proceed();
    return result;
    // â† ì—¬ê¸°ì„œ íŠ¸ëœì­ì…˜ ì»¤ë°‹!
}
```

- `REQUIRES_NEW`ê°€ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì„ ìƒì„±
- `CreateOrderService`ì˜ `@Transactional`ì€ ì´ íŠ¸ëœì­ì…˜ì— í•©ë¥˜ (ê¸°ë³¸ propagation = REQUIRED)
- **AopForTransaction ì¢…ë£Œ ì‹œì  = íŠ¸ëœì­ì…˜ ì»¤ë°‹**

#### ë¬¸ì œ 2: AFTER_COMMITì˜ ì˜ë¯¸

```java
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
```

- `AFTER_COMMIT` = **COMMIT ëª…ë ¹ì„ DBì— ë³´ë‚¸ ì§í›„**
- â‰  "ëª¨ë“  ì„¸ì…˜ì—ì„œ ì½ì„ ìˆ˜ ìˆê²Œ ëœ í›„"

#### ë¬¸ì œ 3: @Async = ë‹¤ë¥¸ DB ì„¸ì…˜

```java
@Async
public void handleOrderCompleted(OrderCompletedEvent event) {
    // ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ = ìƒˆë¡œìš´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ = ìƒˆë¡œìš´ DB ì„¸ì…˜
}
```

### 3. ì‹œê°„ ìˆœì„œë¡œ ë³¸ ë¬¸ì œ ë°œìƒ ê³¼ì •

```
T1 (0ms):   CreateOrderService.create() ì‹œì‘
T2 (10ms):  orderRepository.save(order) ì‹¤í–‰
            â†’ Orderê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ (ë©”ëª¨ë¦¬)
            â†’ ì•„ì§ DBì— INSERT ì¿¼ë¦¬ ì•ˆ ë‚ ë¦¼

T3 (15ms):  eventPublisher.publishEvent(orderId) ì‹¤í–‰
            â†’ ì´ë²¤íŠ¸ëŠ” íì— ëŒ€ê¸° (ì•„ì§ ì‹¤í–‰ ì•ˆ ë¨)

T4 (20ms):  CreateOrderService.create() ì¢…ë£Œ
T5 (21ms):  AopForTransaction.proceed() ì¢…ë£Œ
            â†’ íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì‘!
            â†’ INSERT INTO orders ... (SQL ì‹¤í–‰)
            â†’ COMMIT (DBì— ëª…ë ¹ ì „ì†¡)

T6 (22ms):  @TransactionalEventListener(AFTER_COMMIT) ë°œë™
            â†’ handleOrderCompleted() í˜¸ì¶œ ì¤€ë¹„

T7 (23ms):  @Asyncë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ ì‹œì‘
            â†’ ìƒˆë¡œìš´ DB ì„¸ì…˜ ìƒì„±
            â†’ SELECT * FROM orders WHERE id = ?
            â†’ âŒ NULL ë°˜í™˜!
```

### 4. ì™œ ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œ ì•ˆ ë³´ì´ëŠ”ê°€?

**MySQLì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€: REPEATABLE READ + MVCC**

```sql
-- ì„¸ì…˜ 1 (íŠ¸ëœì­ì…˜ ì»¤ë°‹)
START TRANSACTION;
INSERT INTO orders VALUES (...);
COMMIT;  -- â† T5: ì»¤ë°‹ ëª…ë ¹ ì „ì†¡

-- ì„¸ì…˜ 2 (@Async ìŠ¤ë ˆë“œ, ê±°ì˜ ë™ì‹œì— ì‹¤í–‰)
START TRANSACTION;  -- â† T7: ìƒˆ íŠ¸ëœì­ì…˜ ì‹œì‘ (ìŠ¤ëƒ…ìƒ· ìƒì„±)
SELECT * FROM orders WHERE id = ?;  -- â† NULL!
```

**MySQL InnoDBì˜ MVCC (Multi-Version Concurrency Control):**
1. COMMIT ëª…ë ¹ì„ ë³´ë‚¸ í›„
2. ì–¸ë‘ ë¡œê·¸ ì •ë¦¬ ë° ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œ ì½ì„ ìˆ˜ ìˆê²Œ ë˜ê¸°ê¹Œì§€
3. **ìˆ˜ ë°€ë¦¬ì´ˆì˜ ì‹œê°„ì°¨ ì¡´ì¬**
4. ê·¸ ì‚¬ì´ì— ìƒˆ íŠ¸ëœì­ì…˜ì´ ì‹œì‘ë˜ë©´ **ìŠ¤ëƒ…ìƒ·ì— ë°˜ì˜ ì•ˆ ë¨**

---

## ì‹œë„í•œ í•´ê²° ë°©ë²•ë“¤

### ì‹œë„ 1: Thread.sleep + Retry ë¡œì§ (ì‹¤íŒ¨)

```java
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
@Async
public void handleOrderCompleted(OrderCompletedEvent event) {
    try {
        Thread.sleep(100);  // DB ì»¤ë°‹ ì™„ë£Œ ëŒ€ê¸°

        Order order = null;
        for (int i = 0; i < 3; i++) {
            order = orderRepository.findById(event.orderId()).orElse(null);
            if (order != null) break;
            Thread.sleep(200);  // ì¬ì‹œë„ ì „ ëŒ€ê¸°
        }

        if (order == null) {
            throw new IllegalStateException("ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤");
        }
    } catch (InterruptedException e) {
        // ...
    }
}
```

**ê²°ê³¼:**
- ëŒ€ê¸° ì‹œê°„ì„ ëŠ˜ë ¤ë„ ì—¬ì „íˆ ì‹¤íŒ¨
- 300ms ì´ˆê¸° ëŒ€ê¸° + 5ë²ˆ ì¬ì‹œë„ (500ms ê°„ê²©) = ìµœëŒ€ 2.8ì´ˆ ëŒ€ê¸°
- ê·¼ë³¸ì ì¸ í•´ê²°ì±…ì´ ì•„ë‹˜

**ì‹¤íŒ¨ ì´ìœ :**
- ì„¸ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ë¬¸ì œëŠ” ì‹œê°„ìœ¼ë¡œ í•´ê²° ì•ˆ ë¨
- ìƒˆë¡œìš´ ì„¸ì…˜ì´ ì‹œì‘ë  ë•Œ ì´ë¯¸ ìŠ¤ëƒ…ìƒ·ì´ ê³ ì •ë¨

### ì‹œë„ 2: ë¦¬ìŠ¤ë„ˆì— @Transactional ì¶”ê°€ (ì—ëŸ¬ ë°œìƒ)

```java
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
@Transactional(readOnly = true)
@Async
public void handleOrderCompleted(OrderCompletedEvent event) {
    // ...
}
```

**ê²°ê³¼:**
```
IllegalStateException: @TransactionalEventListener method must not be
annotated with @Transactional unless when declared as REQUIRES_NEW or NOT_SUPPORTED
```

**ì‹¤íŒ¨ ì´ìœ :**
- `@TransactionalEventListener`ì™€ `@Transactional`ì˜ ì¡°í•© ì œí•œ
- `REQUIRES_NEW`ë‚˜ `NOT_SUPPORTED`ë§Œ í—ˆìš©
- í•˜ì§€ë§Œ ì´ê²ƒë„ ê·¼ë³¸ í•´ê²°ì±…ì´ ì•„ë‹˜

---

## ìµœì¢… í•´ê²° ë°©ë²•

### Order ì—”í‹°í‹°ë¥¼ ì§ì ‘ ì „ë‹¬

DB ì¬ì¡°íšŒë¥¼ ì—†ì• ëŠ” ë°©ì‹ìœ¼ë¡œ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í–ˆë‹¤.

```java
// OrderCompletedEvent.java (ìˆ˜ì •)
public record OrderCompletedEvent(Order order) {  // orderId â†’ order
}

// CreateOrderService.java (ìˆ˜ì •)
@Transactional
public OrderResponse create(CreateOrderRequest request) {
    OrderFacade.OrderResult result = orderFacade.createOrder(...);

    // Order ì—”í‹°í‹° ì „ì²´ë¥¼ ì „ë‹¬
    eventPublisher.publishEvent(new OrderCompletedEvent(result.order()));

    return OrderResponse.from(...);
}

// OrderEventListener.java (ìˆ˜ì •)
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
@Async
public void handleOrderCompleted(OrderCompletedEvent event) {
    // DB ì¡°íšŒ ë¶ˆí•„ìš”! ë°”ë¡œ ì‚¬ìš©
    externalDataPlatformService.sendOrderData(event.order());

    log.info("[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì™¸ë¶€ ë°ì´í„° ì „ì†¡ ì™„ë£Œ - Order ID: {}",
             event.order().getOrderId());
}
```

### í•´ê²° ì›ë¦¬

**Order ì—”í‹°í‹°ëŠ” Detached ìƒíƒœì§€ë§Œ:**
1. ì´ë¯¸ ëª¨ë“  í•„ë“œ ê°’ì´ ë©”ëª¨ë¦¬ì— ë¡œë”©ë¨
2. `getOrderId()`, `getTotalAmount()` ë“± ë‹¨ìˆœ getterëŠ” **Lazy Loading ì•„ë‹˜**
3. DB ì¬ì¡°íšŒ ë¶ˆí•„ìš” â†’ íŠ¸ëœì­ì…˜ íƒ€ì´ë° ì´ìŠˆ ì™„ì „ íšŒí”¼

**í…ŒìŠ¤íŠ¸ ê²°ê³¼:**
```
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì£¼ë¬¸ ì™„ë£Œ ì´ë²¤íŠ¸ ìˆ˜ì‹  - Order ID: 1a769366-fc53-468f-930d-b458a8ecef92
[ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] ì™¸ë¶€ ë°ì´í„° ì „ì†¡ ì™„ë£Œ - Order ID: 1a769366-fc53-468f-930d-b458a8ecef92
BUILD SUCCESSFUL
```

âœ… **ì—ëŸ¬ ì™„ì „íˆ í•´ê²°!**

---

## ì¥ë‹¨ì  ë¹„êµ

### ë°©ë²• 1: IDë§Œ ì „ë‹¬ + DB ì¬ì¡°íšŒ

```java
eventPublisher.publishEvent(new OrderCompletedEvent(orderId));
```

**ì¥ì :**
- ì´ë²¤íŠ¸ê°€ ë„ë©”ì¸ ì—”í‹°í‹°ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- ëŠìŠ¨í•œ ê²°í•©
- DDD ê´€ì ì—ì„œ "ì´ìƒì "

**ë‹¨ì :**
- DB ì¬ì¡°íšŒ í•„ìš” â†’ ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ
- íŠ¸ëœì­ì…˜ íƒ€ì´ë° ì´ìŠˆ ë°œìƒ
- Retry ë¡œì§ í•„ìš” â†’ ì½”ë“œ ë³µì¡ë„ ì¦ê°€

### ë°©ë²• 2: Order ì—”í‹°í‹° ì§ì ‘ ì „ë‹¬ (ìµœì¢… ì„ íƒ)

```java
eventPublisher.publishEvent(new OrderCompletedEvent(order));
```

**ì¥ì :**
- DB ì¬ì¡°íšŒ ë¶ˆí•„ìš” â†’ ì„±ëŠ¥ ìš°ìˆ˜
- íŠ¸ëœì­ì…˜ íƒ€ì´ë° ì´ìŠˆ ì—†ìŒ
- ì½”ë“œ ê°„ê²°

**ë‹¨ì :**
- ì´ë²¤íŠ¸ê°€ Order ì—”í‹°í‹°ì— ê²°í•©
- Detached ì—”í‹°í‹° ì „ë‹¬ (Lazy í•„ë“œ ì ‘ê·¼ ì‹œ ì£¼ì˜ í•„ìš”)

### ë°©ë²• 3: DTOë¡œ ì „ë‹¬ (Best Practice)

```java
public record OrderCompletedEvent(
    String orderId,
    String userId,
    long totalAmount,
    long finalAmount
) {
    public static OrderCompletedEvent from(Order order) {
        return new OrderCompletedEvent(
            order.getOrderId(),
            order.getUserId(),
            order.getTotalAmount(),
            order.getFinalAmount()
        );
    }
}
```

**ì¥ì :**
- ëŠìŠ¨í•œ ê²°í•© + DB ì¬ì¡°íšŒ ë¶ˆí•„ìš” (ì–‘ìª½ ì¥ì )
- í•„ìš”í•œ ë°ì´í„°ë§Œ ëª…ì‹œì ìœ¼ë¡œ ì „ë‹¬
- ì§ë ¬í™” ì•ˆì „
- ë¶ˆë³€ì„± ë³´ì¥

**ë‹¨ì :**
- ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ì¦ê°€ (`from()` ë©”ì„œë“œ)

---

## í•™ìŠµ í¬ì¸íŠ¸

### 1. @TransactionalEventListenerì˜ AFTER_COMMIT ì˜ë¯¸

- **AFTER_COMMIT â‰  ëª¨ë“  ì„¸ì…˜ì—ì„œ ì½ì„ ìˆ˜ ìˆê²Œ ëœ í›„**
- **AFTER_COMMIT = COMMIT ëª…ë ¹ì„ ë³´ë‚¸ ì§í›„**
- ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œ ì¦‰ì‹œ ì½ì„ ìˆ˜ ìˆë‹¤ëŠ” ë³´ì¥ ì—†ìŒ

### 2. @Asyncì˜ ì˜í–¥

- ë‹¤ë¥¸ ìŠ¤ë ˆë“œ = ë‹¤ë¥¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸
- ë‹¤ë¥¸ DB ì„¸ì…˜ = ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ ìŠ¤ëƒ…ìƒ·
- MVCC + ê²©ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ ì¸í•œ íƒ€ì´ë° ì´ìŠˆ ê°€ëŠ¥

### 3. Propagation.REQUIRES_NEWì˜ ë™ì‘

```java
@Transactional(propagation = Propagation.REQUIRES_NEW)
public Object proceed(ProceedingJoinPoint joinPoint) {
    // ìƒˆ íŠ¸ëœì­ì…˜ ì‹œì‘
    Object result = joinPoint.proceed();
    return result;
    // ë©”ì„œë“œ ì¢…ë£Œ = íŠ¸ëœì­ì…˜ ì»¤ë°‹
}
```

- í•­ìƒ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ ìƒì„±
- ë‚´ë¶€ `@Transactional`ì€ ì´ íŠ¸ëœì­ì…˜ì— í•©ë¥˜ (REQUIRED)
- **ì™¸ë¶€ ë©”ì„œë“œ ì¢…ë£Œ ì‹œì ì´ ì»¤ë°‹ ì‹œì **

### 4. MySQL MVCCì™€ ê²©ë¦¬ ìˆ˜ì¤€

- InnoDBì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€: REPEATABLE READ
- íŠ¸ëœì­ì…˜ ì‹œì‘ ì‹œ ìŠ¤ëƒ…ìƒ· ìƒì„±
- COMMIT ì§í›„ ìƒˆ íŠ¸ëœì­ì…˜ì€ ë³€ê²½ì‚¬í•­ì„ ëª» ë³¼ ìˆ˜ ìˆìŒ
- ì–¸ë‘ ë¡œê·¸ ì •ë¦¬ê¹Œì§€ ìˆ˜ ë°€ë¦¬ì´ˆ ì†Œìš”

---

## ê²°ë¡ 

**ë¬¸ì œ:**
- `@TransactionalEventListener(AFTER_COMMIT)` + `@Async` í™˜ê²½ì—ì„œ
- ë‹¤ë¥¸ ì„¸ì…˜ì˜ ìƒˆ íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ëœ ë°ì´í„°ë¥¼ ì¦‰ì‹œ ëª» ì½ëŠ” ë¬¸ì œ

**ê·¼ë³¸ ì›ì¸:**
- íŠ¸ëœì­ì…˜ ì»¤ë°‹ íƒ€ì´ë°ê³¼ ë‹¤ë¥¸ ì„¸ì…˜ì˜ ìŠ¤ëƒ…ìƒ· ìƒì„± íƒ€ì´ë° ì°¨ì´
- MySQL MVCCì™€ ê²©ë¦¬ ìˆ˜ì¤€

**í•´ê²°:**
- ID ëŒ€ì‹  **ì—”í‹°í‹° ë˜ëŠ” DTOë¥¼ ì§ì ‘ ì „ë‹¬**í•˜ì—¬ DB ì¬ì¡°íšŒ ì œê±°
- ì‹¤ë¬´ì—ì„œëŠ” **DTO ì „ë‹¬ ë°©ì‹ ê¶Œì¥** (ëŠìŠ¨í•œ ê²°í•© + ì„±ëŠ¥)

**êµí›ˆ:**
- Thread.sleepì´ë‚˜ RetryëŠ” ê·¼ë³¸ í•´ê²°ì±…ì´ ì•„ë‹˜
- ë¶„ì‚° í™˜ê²½ì´ë‚˜ ë¹„ë™ê¸° ì²˜ë¦¬ì—ì„œëŠ” **íŠ¸ëœì­ì…˜ ê²½ê³„ì™€ ë°ì´í„° ì „ë‹¬ ë°©ì‹**ì„ ì‹ ì¤‘íˆ ì„¤ê³„í•´ì•¼ í•¨
- ì´ë¡ ì ìœ¼ë¡œ "ì¢‹ì€" ì„¤ê³„ê°€ í•­ìƒ ì‹¤ì œë¡œë„ ì¢‹ì€ ê²ƒì€ ì•„ë‹˜

---

## ğŸ¤” í•´ê²°í•˜ê³  ë‚˜ë‹ˆ ìƒê¸´ ì˜ë¬¸ â€” "@Async, ì •ë§ ì•ˆì „í•œê°€?"

ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  í…ŒìŠ¤íŠ¸ë„ í†µê³¼í–ˆë‹¤. ì„±ê³µì´ë‹¤!

í•˜ì§€ë§Œ ë­”ê°€ ì°ì°í–ˆë‹¤.

```java
@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
@Async  // â† ì´ê±°...
public void handleOrderCompleted(OrderCompletedEvent event) {
    externalDataPlatformService.sendOrderData(event.order());
}
```

**"@Asyncë¥¼ ì“°ë©´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ê±´ë°... ê´œì°®ì€ ê±°ì•¼?"**

ì†Œê·œëª¨ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì˜ ëŒì•„ê°„ë‹¤. í•˜ì§€ë§Œ ë¬¸ë“ ì´ëŸ° ìƒê°ì´ ë“¤ì—ˆë‹¤.

**"ë§Œì•½ ì£¼ë¬¸ì´ ì´ˆë‹¹ 1000ê±´ì”© ë“¤ì–´ì˜¤ë©´?"**
**"@Async ìŠ¤ë ˆë“œí’€ì´ ê½‰ ì°¨ë©´ ì–´ë–»ê²Œ ë˜ì§€?"**
**"ê·¸ëŸ¼ ì™¸ë¶€ API ì „ì†¡ì´ ì‹¤íŒ¨í•˜ëŠ” ê±° ì•„ëƒ?"**

ì´ ì˜ë¬¸ì„ íŒŒê³ ë“¤ê¸° ì‹œì‘í–ˆë‹¤.

---

## ğŸ“š ìŠ¤ë ˆë“œì˜ ë³¸ì§ˆì„ ì´í•´í•˜ë‹¤

### 1. ìŠ¤ë ˆë“œ(Thread)ë€? â€” ê°€ì¥ ê¸°ë³¸ë¶€í„° ë‹¤ì‹œ ìƒê°í•´ë³´ì

ì²˜ìŒì—” ë‹¹ì—°í•˜ê²Œ ì—¬ê²¼ë˜ ê²ƒë“¤ì„ ë‹¤ì‹œ ìƒê°í•´ë´¤ë‹¤.

**"ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤ëŠ” ê±´ ë­˜ê¹Œ?"**

ë‹µì€ ê°„ë‹¨í–ˆë‹¤. **CPUì—ê²Œ "ì´ ì‘ì—… ì¢€ í•´ì¤˜"ë¼ê³  ìš”ì²­í•˜ëŠ” ê²ƒ**ì´ê³ , ê·¸ ìš”ì²­ ë‹¨ìœ„ê°€ ë°”ë¡œ **ìŠ¤ë ˆë“œ**ì´ë‹¤.

- ëª¨ë“  ì½”ë“œ ì‹¤í–‰ì€ ë¬´ì¡°ê±´ ìŠ¤ë ˆë“œ ìœ„ì—ì„œ ì´ë£¨ì–´ì§
- ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ëŒì•„ê°„ë‹¤ëŠ” ê²ƒ = ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì¼í•˜ê³  ìˆë‹¤ëŠ” ê²ƒ

ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê¹¨ë‹¬ìŒì´ ìˆì—ˆë‹¤.

**"ìŠ¤ë ˆë“œê°€ ë§ìœ¼ë©´ ë§ì„ìˆ˜ë¡ ì¢‹ì€ ê±° ì•„ë‹Œê°€?"**

ì•„ë‹ˆì—ˆë‹¤. ì˜¤íˆë ¤ **ìŠ¤ë ˆë“œê°€ ë§ì•„ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤.** ì™œ ê·¸ëŸ´ê¹Œ?

### 2. CPU Coreë€? â€” ì§„ì§œ ì¼í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒ ìˆ˜

ë‹µì€ **CPU ì½”ì–´**ì— ìˆì—ˆë‹¤.

CPU ì½”ì–´ëŠ” **"í•œ ìˆœê°„ì— ì‹¤ì œë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìŠ¤ë ˆë“œ ìˆ˜"**ì´ë‹¤.

- 1ì½”ì–´ â†’ ë™ì‹œì— ë”± 1ê°œ ìŠ¤ë ˆë“œë§Œ ì‹¤í–‰ ê°€ëŠ¥
- 8ì½”ì–´ â†’ ë™ì‹œì— ë”± 8ê°œ ìŠ¤ë ˆë“œë§Œ ì‹¤í–‰ ê°€ëŠ¥
- ë‚˜ë¨¸ì§€ ìŠ¤ë ˆë“œëŠ”? â†’ **ì „ë¶€ ëŒ€ê¸°**

ì˜ˆë¥¼ ë“¤ì–´, 8ì½”ì–´ CPUì—ì„œ ìŠ¤ë ˆë“œ 100ê°œê°€ ëŒì•„ê°€ê³  ìˆë‹¤ë©´:
- ì‹¤ì œë¡œ ì¼í•˜ëŠ” ìŠ¤ë ˆë“œ: 8ê°œ
- ì¤„ ì„œì„œ ê¸°ë‹¤ë¦¬ëŠ” ìŠ¤ë ˆë“œ: 92ê°œ

ì—¬ê¸°ì„œ ì¶©ê²©ì ì¸ ì‚¬ì‹¤ì„ í•˜ë‚˜ ë” ì•Œê²Œ ë˜ì—ˆë‹¤.

**CPUëŠ” ìŠ¤ë ˆë“œë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤:**
- í†°ìº£ ìŠ¤ë ˆë“œë“ 
- @Async ìŠ¤ë ˆë“œë“ 
- Kafka consumerë“ 

**CPU ì…ì¥ì—ì„œëŠ” ê·¸ëƒ¥ "ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ"ì¼ ë¿ì´ë‹¤.**

ì¦‰, í†°ìº£ ìŠ¤ë ˆë“œ 200ê°œ + @Async ìŠ¤ë ˆë“œ 100ê°œ = ì´ 300ê°œê°€ ìˆì–´ë„,
8ì½”ì–´ CPUëŠ” ë™ì‹œì— ë”± 8ê°œë§Œ ì‹¤í–‰í•œë‹¤.

### 3. Context Switching â€” ìŠ¤ë ˆë“œê°€ ë§ìœ¼ë©´ ì˜¤íˆë ¤ ëŠë ¤ì§€ëŠ” ì§„ì§œ ì´ìœ 

ê·¸ëŸ¼ ì´ëŸ° ì˜ë¬¸ì´ ë“ ë‹¤.

**"8ê°œë§Œ ë™ì‹œ ì‹¤í–‰ì´ë©´, ë‚˜ë¨¸ì§€ 92ê°œëŠ” ì˜ì›íˆ ì‹¤í–‰ ì•ˆ ë˜ëŠ” ê±°ì•¼?"**

ì•„ë‹™ë‚˜. CPUê°€ **ì—„ì²­ ë¹ ë¥´ê²Œ ë²ˆê°ˆì•„ê°€ë©°** ì‹¤í–‰í•´ì¤ë‚˜.
ì´ê²Œ ë°”ë¡œ **Context Switching(ë¬¸ë§¥ êµí™˜)**ì´ë‹¤.

**Context Switchingì´ë€?**
CPUê°€ ì‹¤í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œë¥¼ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¡œ ë°”ê¿€ ë•Œ ë°œìƒí•˜ëŠ” ê³¼ì •ì´ë‹¤.

**ì–¸ì œ ë°œìƒí•˜ë‚˜?**
1. íƒ€ì„ìŠ¬ë¼ì´ìŠ¤(time slice) ì¢…ë£Œ â€” "ë„ˆëŠ” ì¶©ë¶„íˆ ì¼ìœ¼ë‹ˆê¹Œ ë‹¤ìŒ ì‚¬ëŒ ì°¨ë¡€"
2. I/O ëŒ€ê¸°(BLOCK) â€” "DB ì‘ë‹µ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ëŒ ì¼ ì‹œí‚¤ì"
3. ë½ ëŒ€ê¸° â€” "ë½ ì–»ì„ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ë‹ˆê¹Œ ë‹¤ë¥¸ ì‚¬ëŒ ì¼ ì‹œí‚¤ì"
4. OS ìŠ¤ì¼€ì¤„ëŸ¬ íŒë‹¨ â€” "ìš°ì„ ìˆœìœ„ ë†’ì€ ì• ê°€ ì™”ìœ¼ë‹ˆ ë°”ê¿”!"

**ë¬¸ì œëŠ” ì´ê±°ë‹¤:**

ìŠ¤ë ˆë“œ ì „í™˜ì—ë„ ë¹„ìš©ì´ ë“ ë‹¤.
- í˜„ì¬ ìŠ¤ë ˆë“œ ìƒíƒœ ì €ì¥ (ë ˆì§€ìŠ¤í„°, ìŠ¤íƒ í¬ì¸í„° ë“±)
- ë‹¤ìŒ ìŠ¤ë ˆë“œ ìƒíƒœ ë³µì›
- ìºì‹œ ë¬´íš¨í™”

**ìŠ¤ë ˆë“œê°€ 8ê°œ â†’ 16ê°œ â†’ 100ê°œë¡œ ëŠ˜ì–´ë‚˜ë©´?**
- CPUëŠ” ì ì  ë” ìì£¼ ì „í™˜í•´ì•¼ í•¨
- ì‹¤ë‚´ ì¼í•˜ëŠ” ì‹œê°„ì€ ì¤„ì–´ë“¤ê³ , ì „í™˜í•˜ëŠ” ì‹œê°„ë§Œ ëŠ˜ì–´ë‚¨
- CPU ì‚¬ìš©ë¥ ì€ 100%ì¸ë° ì‹¤ë‚´ ì²˜ë¦¬ëŸ‰ì€ â†“

ì´ê²Œ ë°”ë¡œ **ìŠ¤ë ˆë“œ ìˆ˜ê°€ ë§ìœ¼ë©´ ì„±ëŠ¥ì´ ì¢‹ì•„ì§€ì§€ ì•Šê³  ì˜¤íˆë ¤ ë–¨ì–´ì§€ëŠ” ì´ìœ **ì´ë‹¤.

ë‚´ ë¨¸ë¦¿ì†ì— ì´ëŸ° ê·¸ë¦¼ì´ ê·¸ë ¤ì¡ŒìŠµë‹ˆë‹¤:
```
ìŠ¤ë ˆë“œ 8ê°œ:  ì¼ â†’ ì¼ â†’ ì¼ â†’ ì¼ (ê°€ë” ì „í™˜)
ìŠ¤ë ˆë“œ 100ê°œ: ì „í™˜ â†’ ì¼ â†’ ì „í™˜ â†’ ì¼ â†’ ì „í™˜ â†’ ì¼ (ê³„ì† ì „í™˜ë§Œ...)
```

### 4. í†°ìº£ ìŠ¤ë ˆë“œ vs @Async ìŠ¤ë ˆë“œ â€” ì°©ê°í–ˆë˜ ë¶€ë¶„

ì—¬ê¸°ì„œ ë‚´ê°€ ì°©ê°í–ˆë˜ ë¶€ë¶„ì´ ìˆë‹¤.

**"í†°ìº£ ìŠ¤ë ˆë“œë‘ @Async ìŠ¤ë ˆë“œëŠ” ë³„ê°œë‹ˆê¹Œ, ê°ê° ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•˜ê² ì§€?"**

ë§ê¸°ë„ í•˜ê³  í‹€ë¦¬ê¸°ë„ í•œë‹¤.

#### í†°ìº£ ìŠ¤ë ˆë“œ
- HTTP ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œ
- ê¸°ë³¸ maxThreads ì•½ 200ê°œ
- ì‚¬ìš©ì ìš”ì²­ì´ ì˜¤ë©´ ì´ í’€ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ê°€ì ¸ë‹¤ ì”€

#### @Async ìŠ¤ë ˆë“œ
- ìŠ¤í”„ë§ì´ ë‚´ë¶€ ë¹„ë™ê¸°ë¡œ ì‚¬ìš©í•˜ëŠ” **ë³„ë„ ìŠ¤ë ˆë“œí’€**
- ê¸°ë³¸ 8ê°œ ì •ë„
- í†°ìº£ê³¼ **ì™„ì „íˆ ë…ë¦½ì ì¸ í’€**

"ë³„ê°œ"ë¼ëŠ” ê±´ ë§ë‹¤. í†°ìº£ ìŠ¤ë ˆë“œ 200ê°œê°€ ë‹¤ ì°¨ë„, @Async ìŠ¤ë ˆë“œ 8ê°œëŠ” ë”°ë¡œ ìˆìœ¼ë‹ˆê¹Œìš”.

**í•˜ì§€ë§Œ CPU ì…ì¥ì—ì„œëŠ”?**

ë‘˜ ë‹¤ ê·¸ëƒ¥ "ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ"ì¼ ë¿ì´ë‹¤.

í†°ìº£ 200ê°œ + @Async 8ê°œ = ì´ 208ê°œ ìŠ¤ë ˆë“œê°€
8ì½”ì–´ CPUì—ì„œ ë™ì‹œì— ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ê°œìˆ˜ëŠ” **ì—¬ì „íˆ 8ê°œ**ì´ë‹¤.

ì¦‰, ìŠ¤ë ˆë“œí’€ì„ ë‚˜ëˆˆë‹¤ê³  CPU ì½”ì–´ê°€ ëŠ˜ì–´ë‚˜ëŠ” ê²Œ ì•„ë‹™ë‚˜.
---

## ğŸ˜± @Asyncì˜ ì–´ë‘ìš´ ë©´ì„ ë°œê²¬í•˜ë‹¤

ì—¬ê¸°ê¹Œì§€ ì´í•´í•˜ê³  ë‚˜ë‹ˆ, ë“±ê³¨ì´ ì˜¤ì‹¹í•´ì¡Œë‹¤.

**"ì ê¹, ê·¸ëŸ¼ ë‚´ê°€ ë§Œë“  ì‹œìŠ¤í…œ... íŠ¸ë˜í”½ ëª°ë¦¬ë©´ í„°ì§€ëŠ” ê±° ì•„ëƒ?"**

### 5. @Asyncê°€ ìœ„í—˜í•œ ì´ìœ  â€” ì†Œê·œëª¨ì—ì„  ê´œì°®ì§€ë§Œ...

ì²˜ìŒì— @Asyncë¥¼ ì“¸ ë•ŒëŠ” ì´ë ‡ê²Œ ìƒê°í–ˆë‹¤:

**"ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ë©´ ë©”ì¸ ë¡œì§ì´ ë¹¨ë¦¬ ëë‚˜ë‹ˆê¹Œ ì¢‹ì€ ê±° ì•„ëƒ?"**

ë§ë‹¤. **ì†Œê·œëª¨ì—ì„œëŠ”** ê´œì°®ë‹¤.

í•˜ì§€ë§Œ íŠ¸ë˜í”½ì´ ëª°ë¦¬ë©´ ì´ì•¼ê¸°ê°€ ì™„ì „íˆ ë‹¬ë¼ì§‘ë‚˜.

#### @Asyncì˜ ìœ„í—˜ì„±

1. **ìŠ¤ë ˆë“œí’€ ê³ ê°ˆ** â†’ ì‘ì—… ìœ ì‹¤
   - íê°€ ê½‰ ì°¨ë©´ RejectedExecutionException
   - ì‘ì—…ì´ ê·¸ëŒ€ë¡œ ì¦ë°œ (ì¬ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ ì—†ìŒ)

2. **context switching í­ë°œ** â†’ CPU ì‚¬ìš©ëŸ‰ í­ì¦
   - ìŠ¤ë ˆë“œ ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì „í™˜ ë¹„ìš© ì¦ê°€
   - CPUëŠ” 100%ì¸ë° ì‹¤ë‚´ ì²˜ë¦¬ëŠ” ëŠë ¤ì§

3. **ë©”ëª¨ë¦¬ ë¶€ì¡±(OOM)**
   - ìŠ¤ë ˆë“œ 1ê°œë‹¹ ìˆ˜ MBì˜ ë©”ëª¨ë¦¬
   - ìŠ¤ë ˆë“œ 100ê°œë©´ ìˆ˜ë°± MBê°€ ìˆœì‹ê°„ì— ì¦ë°œ

4. **ì‹¤íŒ¨ ì‹œ ì¬ì²˜ë¦¬ ë¶ˆê°€**
   - Kafkaì²˜ëŸ¼ ë©”ì‹œì§€ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ
   - í•œ ë²ˆ ì‹¤íŒ¨í•˜ë©´ ë

5. **ê³ ë™ì‹œì„±ì—ì„œ ì„œë²„ ë°”ë¡œ í„°ì§**
   - í”¼í¬ ì‹œê°„ì— @Async ì‘ì—… í­ì¦
   - ìŠ¤ë ˆë“œí’€ ê³ ê°ˆ + CPU í­ë°œ + ë©”ëª¨ë¦¬ ë¶€ì¡±
   - ì„œë²„ ë‹¤ìš´

ê·¸ë˜ì„œ ê¹¨ë‹¬ì•˜ë‹¤.

**â†’ ê³ íŠ¸ë˜í”½ í™˜ê²½ì—ì„œ @AsyncëŠ” ì ˆëŒ€ ì“°ë©´ ì•ˆ ë¨**

"ê·¸ëŸ¼ ëŒ€ì•ˆì´ ë­”ë°?" ì—¬ê¸°ì„œ Kafkaê°€ ë“±ì¥í•œë‹¤.
---

## ğŸ’¡ ë” ë‚˜ì€ í•´ê²°ì±…ì„ ì°¾ì•„ì„œ â€” Kafkaì˜ ë“±ì¥

"@AsyncëŠ” ìœ„í—˜í•˜ë‹¤. ê·¸ëŸ¼ ëŒ€ì•ˆì´ ë­ì§€?"

ìŠ¤ë ˆë“œí’€ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ë©´ ë ê¹Œ? ì•„ë‹ˆë‹¤. ì•ì—ì„œ ë´¤ë“¯ì´ ìŠ¤ë ˆë“œê°€ ë§ì•„ì§€ë©´ ì˜¤íˆë ¤ ëŠë ¤ì§„ë‹¤.

ì—¬ê¸°ì„œ ì™„ì „íˆ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ì´ í•„ìš”í•˜ë‹¤ëŠ” ê±¸ ê¹¨ë‹¬ì•˜ë‹¤.

### 6. ì™œ Kafka ê°™ì€ ë©”ì‹œì§€ ë¸Œë¡œì»¤ê°€ í•„ìš”í•œê°€? â€” íŒ¨ëŸ¬ë‹¤ì„ì˜ ì „í™˜

@Asyncì˜ í•œê³„ë¥¼ ì •ë¦¬í•˜ë©´:
- CPU ì˜ì¡´ì„± (ì½”ì–´ ìˆ˜ ì œí•œ)
- ìŠ¤ë ˆë“œí’€ í•œê³„ (ê³ ê°ˆë˜ë©´ ë)
- ë©”ëª¨ë¦¬ í•œê³„ (OOM)
- ì¥ì• ë‚˜ë©´ ë (ì¬ì²˜ë¦¬ ë¶ˆê°€)

**"ê·¸ëŸ¼ ìŠ¤ë ˆë“œí’€ì„ í¬ê²Œ ëŠ˜ë¦¬ë©´ ë˜ì–ì•„?"**

ì•„ë‹ˆìš”. ì•ì—ì„œ ë´¤ë“¯ì´ ìŠ¤ë ˆë“œê°€ ë§ì•„ì§€ë©´ ì˜¤íˆë ¤ ëŠë ¤ì§‘ë‚˜.

ì—¬ê¸°ì„œ íŒ¨ëŸ¬ë‹¤ì„ì˜ ì „í™˜ì´ í•„ìš”í•˜ë‹¤.

**KafkaëŠ” ì™„ì „íˆ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:**

#### Kafkaì˜ í•µì‹¬ íŠ¹ì„±

1. **ìŠ¤ë ˆë“œë¥¼ ê±°ì˜ ì•ˆ ì”€**
   - ë©”ì‹œì§€ë¥¼ ë””ìŠ¤í¬ì— ì €ì¥ë§Œ í•¨
   - Consumerê°€ ì›í•  ë•Œ ê°€ì ¸ê°

2. **ë©”ì‹œì§€ë¥¼ ë””ìŠ¤í¬ì— ì €ì¥**
   - ë©”ëª¨ë¦¬ê°€ ì•„ë‹ˆë¼ ë””ìŠ¤í¬
   - ì„œë²„ êº¼ì ¸ë„ ë©”ì‹œì§€ ìœ ì§€

3. **ìƒì‚° ì†ë„ì™€ ì†Œë¹„ ì†ë„ ë…ë¦½**
   - ProducerëŠ” ì´ˆë‹¹ 10ë§Œ ê±´ ë³´ë‚´ë„ ë¨
   - ConsumerëŠ” ì²œì²œíˆ ì²˜ë¦¬í•´ë„ ë¨
   - ê¸‰í•˜ì§€ ì•ŠìŒ

4. **ì‹¤íŒ¨í•´ë„ ì¬ì²˜ë¦¬ ê°€ëŠ¥**
   - ë©”ì‹œì§€ê°€ ë””ìŠ¤í¬ì— ìˆìœ¼ë‹ˆê¹Œ
   - ë‹¤ì‹œ ê°€ì ¸ì™€ì„œ ì¬ì²˜ë¦¬

5. **ìˆ˜í‰ í™•ì¥ ìš©ì´**
   - Consumerë¥¼ ì—¬ëŸ¬ ê°œ ë„ìš°ë©´ ë¨
   - íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ë¶„ì‚° ì²˜ë¦¬

6. **ë¬´í•œíˆ ìŒ“ì•„ë‘˜ ìˆ˜ ìˆìŒ**
   - ë””ìŠ¤í¬ ìš©ëŸ‰ë§Œí¼
   - @AsyncëŠ” íê°€ ê½‰ ì°¨ë©´ ì—ëŸ¬

ì¦‰, **KafkaëŠ” ìŠ¤ë ˆë“œ ê¸°ë°˜ ë¹„ë™ê¸°ì˜ í•œê³„ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ íƒœì–´ë‚œ êµ¬ì¡°**ì´ë‹¤.

"ì•„, ê·¸ë˜ì„œ ì‚¬ëŒë“¤ì´ Kafkaë¥¼ ì“°ëŠ”êµ¬ë‚˜!" ë“œë””ì–´ ì´í•´ê°€ ëë‹¤.

### 7. ì™œ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜(EDA)ê°€ í•„ìš”í•œê°€?

**ê¸°ì¡´ì˜ ë¬¸ì œ:**
- ì£¼ë¬¸/ê²°ì œ/ì¿ í°/ì¬ê³ /í¬ì¸íŠ¸ ë“± ëª¨ë“  ë¡œì§ì´ í•œ íŠ¸ëœì­ì…˜ì— ì„ì„
- ëŠ¦ì–´ì§
- ë¡¤ë°±ë˜ë©´ ì „ì²´ ì‹¤íŒ¨
- ì¥ì•  ìœ„í—˜ ì¦ê°€

**EDA ì ìš© í›„:**
- í•µì‹¬ ë¡œì§ + ë¶€ê°€ ë¡œì§ ë¶„ë¦¬
- íŠ¸ëœì­ì…˜ ê°€ë²¼ì›Œì§
- ì™¸ë¶€ API ì‹¤íŒ¨í•´ë„ ì£¼ë¬¸ì€ ì„±ê³µ
- ìœ ì§€ë³´ìˆ˜ì„± ì¦ê°€
- ë„ë©”ì¸ ê°„ ê²°í•©ë„ ê°ì†Œ

### 8. ì „ì²´ íë¦„ ì •ë¦¬

```
[ì‚¬ìš©ì ìš”ì²­]
     â†“
[í†°ìº£ ìŠ¤ë ˆë“œ]  â† CPU ë™ì‹œì— ì²˜ë¦¬ ê°€ëŠ¥í•œ ê°œìˆ˜ = ì½”ì–´ ìˆ˜
     â†“
[ìŠ¤í”„ë§ ì„œë¹„ìŠ¤ ë¡œì§]
     â†“
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ @Async ë¡œ ë¹„ë™ê¸° ì‘ì—… ìƒì„±  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
[ìŠ¤í”„ë§ ë¹„ë™ê¸° ìŠ¤ë ˆë“œí’€]  â† ìŠ¤ë ˆë“œ ì¦ê°€ â†’ context switching í­ë°œ â†’ ì¥ì• 
     â†“
(ì¬ì²˜ë¦¬ ë¶ˆê°€ / ë©”ì‹œì§€ ìœ ì‹¤ / ì„œë²„ ì£½ìŒ)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì—¬ê¸°ê¹Œì§€ê°€ ìŠ¤ë ˆë“œ ê¸°ë°˜ ë¹„ë™ê¸°ì˜ í•œê³„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ì´ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ë“±ì¥í•œ ê²Œ â†’ Kafka / RabbitMQ / SQS

[Kafka Producer]
     â†“
[Kafka Broker (ë””ìŠ¤í¬ ì €ì¥)]
     â†“
[Kafka Consumer]
     â†“
(ì¬ì²˜ë¦¬ ê°€ëŠ¥ / ì¥ì• ì— ê°•í•¨ / ìŠ¤ë ˆë“œë¥¼ ë§ì´ ì“°ì§€ ì•ŠìŒ / ê³ ì„±ëŠ¥)
```

### 9. ìŠ¤í”„ë§ ë¹„ë™ê¸° ìŠ¤ë ˆë“œí’€ ì„¤ì • 3ìš”ì†Œ

#### 1ï¸âƒ£ corePoolSize (ê¸°ë³¸ ìŠ¤ë ˆë“œ ìˆ˜)
- í•­ìƒ ìœ ì§€í•˜ë ¤ê³  í•˜ëŠ” ìŠ¤ë ˆë“œ ìˆ˜
- ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ë¨¼ì € core ê°œìˆ˜ë§Œí¼ ìŠ¤ë ˆë“œë¥¼ ë§Œë“  ë’¤, ê·¸ ì•ˆì—ì„œ ì‘ì—… ì²˜ë¦¬
- ì´ ê°œìˆ˜ ì´í•˜ë©´ íì— ì•ˆ ë„£ê³  ë°”ë¡œë°”ë¡œ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•¨

**ì˜ˆ:**
```java
corePoolSize = 8
ë¹„ë™ê¸° ì‘ì—… 1~8ê°œ â†’ ìŠ¤ë ˆë“œ 8ê°œê¹Œì§€ ë°”ë¡œ ë§Œë“¤ì–´ì„œ ë³‘ë ¬ ì²˜ë¦¬
```

#### 2ï¸âƒ£ maxPoolSize (ìµœëŒ€ ìŠ¤ë ˆë“œ ìˆ˜)
- ìµœëŒ€ë¡œ ëŠ˜ë¦´ ìˆ˜ ìˆëŠ” ìŠ¤ë ˆë“œ ìˆ˜ ìƒí•œ
- ë™ì‘ ìˆœì„œ:
  1. corePoolSizeê¹Œì§€ ìŠ¤ë ˆë“œ ì±„ì›€
  2. ê·¸ ë’¤ë¡œëŠ” queueCapacity ë§Œí¼ íì— ìŒ“ìŒ
  3. íë„ ê½‰ ì°¼ì„ ë•Œ â†’ ìŠ¤ë ˆë“œë¥¼ ë” ë§Œë“¤ì–´ì„œ maxPoolSizeê¹Œì§€ ëŠ˜ë¦¼

**ì˜ë¯¸:**
- `corePoolSize` = ê¸°ë³¸ ë³‘ë ¬ ì²˜ë¦¬ëŸ‰
- `maxPoolSize` = ìœ„ê¸° ìƒí™©ì—ì„œ í„°ì§€ê¸° ì§ì „ì— í•œ ë²ˆ ë” ë²„í‹°ëŠ” ë¹„ìƒìš©

#### 3ï¸âƒ£ queueCapacity (ëŒ€ê¸°ì—´ í¬ê¸°)
- ìŠ¤ë ˆë“œê°€ ë‹¤ ë°”ì  ë•Œ, ì‘ì—…ì„ ì ì‹œ ìŒ“ì•„ë‘ëŠ” ë²„í¼ í¬ê¸°
- corePoolSizeë§Œí¼ ìŠ¤ë ˆë“œê°€ ê½‰ ì°¨ë©´ ìƒˆ ì‘ì—…ì€ ì¼ë‹¨ ì´ íì— ë“¤ì–´ê°
- ë‚˜ì¤‘ì— ìŠ¤ë ˆë“œê°€ ë†€ê²Œ ë˜ë©´ íì—ì„œ í•˜ë‚˜ êº¼ë‚´ì„œ ì‹¤í–‰
- íë§ˆì € ê½‰ ì°¨ë©´? â†’ maxPoolSizeê¹Œì§€ ìŠ¤ë ˆë“œë¥¼ ë” ëŠ˜ë¦´ ìˆ˜ ìˆìŒ
- ê·¸ë˜ë„ ë” ë„£ì„ ìˆ˜ ì—†ìœ¼ë©´ â†’ `RejectedExecutionException` (ë¹„ë™ê¸° ì‘ì—… ê±°ë¶€)

### 10. ìˆ«ì ëŠ˜ë¦°ë‹¤ê³  ë¬´ì¡°ê±´ ì¢‹ì€ ê²Œ ì•„ë‹Œ ì´ìœ  â€” ë‚´ê°€ ì‹¤ì œë¡œ ê²ªì€ ì‹¤ìˆ˜

ì„¤ì •ì„ ì²˜ìŒ ë´¤ì„ ë•Œ ì´ë ‡ê²Œ ìƒê°í–ˆë‹¤:

**"corePoolSizeë¥¼ í¬ê²Œ í•˜ë©´ ë” ë§ì´ ì²˜ë¦¬í•˜ë‹ˆê¹Œ ì¢‹ì€ ê±° ì•„ëƒ?"**

ê·¸ë˜ì„œ 8 â†’ 100ìœ¼ë¡œ ì˜¬ë ¤ë´¤ë‹¤.

#### â‘  corePoolSizeë¥¼ ë§‰ ì˜¬ë¦¬ë©´?

**ì˜ˆ: corePoolSize = 8 â†’ 100 ìœ¼ë¡œ ì˜¬ë¦¼**

**ê¸°ëŒ€:**
- ë™ì‹œì— ë¹„ë™ê¸° ì‘ì—… 100ê°œë¥¼ ë³‘ë ¬ë¡œ ì²˜ë¦¬! ë¹¨ë¼ì§€ê² ì§€?

**í˜„ì‹¤:**
- ìŠ¤ë ˆë“œ 1ê°œë‹¹ ìŠ¤íƒ ë©”ëª¨ë¦¬ + ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ê³µê°„ í•„ìš”
- ìŠ¤ë ˆë“œ 100ê°œ â†’ ë©”ëª¨ë¦¬ ìˆ˜ì‹­~ìˆ˜ë°± MB ìˆœì‹ê°„ì— ì¦ë°œ
- 100ê°œ ì‘ì—…ì´ ë™ì‹œì— DBì— ì¿¼ë¦¬ë¥¼ ë‚ ë¦¼
- **DBê°€ í„°ì§** (ì»¤ë„¥ì…˜ í’€ì€ 20ê°œë°–ì— ì—†ëŠ”ë°?)
- ë‚˜ë¨¸ì§€ 80ê°œ ìŠ¤ë ˆë“œëŠ” DB ì»¤ë„¥ì…˜ ì–»ìœ¼ë ¤ê³  ëŒ€ê¸°
- Context switching í­ë°œ
- CPU 100%, ì‹¤ë‚´ ì²˜ë¦¬ëŸ‰ì€ â†“

**ë‚´ê°€ ê¹¨ë‹¬ì€ ê²ƒ:**

coreë¥¼ ëŠ˜ë¦°ë‹¤ëŠ” ê±´ **"ë™ì‹œì— ë” ë§ì€ ì¼ì„ ë•Œë ¤ë„£ê² ë‹¤"**ëŠ” ì˜ë¯¸ì¸ë°,
ë’·ë‹¨(DB, ì™¸ë¶€ API)ê°€ ê·¸ê±¸ ê°ë‹¹ ëª»í•˜ë©´ **ë³‘ëª©ë§Œ ì»¤ì§‘ë‚˜.**

ë§ˆì¹˜ 8ì°¨ì„  ë„ë¡œì—ì„œ ê°‘ìê¸° 1ì°¨ì„ ìœ¼ë¡œ ì¢ì•„ì§€ëŠ” ê²ƒê³¼ ê°™ë‹¤.

#### â‘¡ maxPoolSizeë¥¼ í¬ê²Œ ì¡ìœ¼ë©´?

**ì˜ˆ: core=8, max=200**

- í‰ì†Œì—” 8ê°œ ìŠ¤ë ˆë“œë¡œ ì˜ ëŒë‹¤ê°€
- í”¼í¬ ë•Œ íê°€ ê½‰ ì°¨ë©´ â†’ ìŠ¤ë ˆë“œë¥¼ 9, 10, â€¦, 200ê¹Œì§€ ëŠ˜ë¦´ ìˆ˜ ìˆìŒ
- **ì´ ìˆœê°„ì´ ë°”ë¡œ í­ë°œ êµ¬ê°„**

**ë¬¸ì œ:**
1. CPU ì½”ì–´ ìˆ˜ë³´ë‹¤ í›¨ì”¬ ë§ì€ ìŠ¤ë ˆë“œë¥¼ ë™ì‹œì— runnableë¡œ ë§Œë“¤ì–´ë²„ë¦¼
   - context switching í­ë°œ
   - CPUê°€ ìŠ¤ë ˆë“œ ì „í™˜ë§Œ í•˜ëŠë¼ ë°”ì¨
2. DB, ì™¸ë¶€ APIì— í­ì£¼
   - í•œêº¼ë²ˆì— 200ê°œê°€ DBì— ì¿¼ë¦¬ ë‚ ë¦¬ë©´?
   - DB ì»¤ë„¥ì…˜ í’€ë„ ê½‰ ì°¨ê³ 
   - ë‚˜ë¨¸ì§€ ìš”ì²­ì€ ëŒ€ê¸°/íƒ€ì„ì•„ì›ƒ
3. ì „ì²´ì ìœ¼ë¡œ ì‘ë‹µì´ ë¹¨ë¼ì§€ëŠ” ê²Œ ì•„ë‹ˆë¼ ì„œë²„ê°€ ê³¼ë¶€í•˜ë¡œ ëŠë ¤ì§

â†’ maxë¥¼ ê´œíˆ í¬ê²Œ ì¡ì•„ë²„ë¦¬ë©´ **"ì„œë²„ì•¼, ìœ„ê¸° ìƒí™© ë•Œ í‰ì†Œì˜ Xë°°ë¡œ ë” ë¯¸ì¹œ ë“¯ì´ ì¼í•´ì¤˜. ë²„í‹°ë‹¤ ì£½ì–´ë„ ë‚œ ëª°ë¼."** ë¼ê³  ê°•ìš”í•˜ëŠ” ì…ˆ

#### â‘¢ queueCapacityë¥¼ í¬ê²Œ ì¡ìœ¼ë©´?

**ì˜ˆ: queueCapacity = 10 â†’ 10_000**

**ì¥ì :**
- í•œë™ì•ˆì€ RejectedExecutionException ì—†ì´ ê³„ì† ìš”ì²­ì„ ë°›ì•„ì¤Œ

**ë‹¨ì :**
- ë©”ëª¨ë¦¬ê°€ íì— ìŒ“ì¸ ì‘ì—…ë“¤ë¡œ ì ì  ë¨¹í˜
- ë¹„ë™ê¸°ì¸ë° ì‹¤ë‚´ ì‹¤í–‰ì€ í•œì°¸ ë’¤ì— ì‹¤í–‰ë¨
  - ì˜ˆ: 10ì´ˆ ë™ì•ˆ ë“¤ì–´ì˜¨ ì‘ì—…ì´ íì— ìŒ“ì˜€ë‹¤ê°€, ìŠ¤ë ˆë“œê°€ ì²˜ë¦¬ ëª» í•´ì„œ 1~2ë¶„ ë’¤ì— ì²˜ë¦¬ë˜ê¸°ë„â€¦
- ì„œë²„ê°€ ë°”ë¹ ì„œ ì´ë¯¸ í­ì£¼ ìƒíƒœì¸ë°, íì— ê³„ì† ìŒ“ì•„ë‘ë©´:
  - ì§„ì§œë¡œ ì‚´ì•„ ìˆì–´ì•¼ í•  ì‘ì—…ê³¼ ì´ë¯¸ ì˜ë¯¸ ì—†ëŠ” ì‘ì—…ì´ ë’¤ì„ì„
  - ì´ ìƒíƒœì—ì„œ ì„œë²„ êº¼ì§€ë©´ íì— ìˆë˜ ê²ƒë“¤ ê·¸ëŒ€ë¡œ ë‹¤ ì¦ë°œ (= ìœ ì‹¤)

â†’ **íë¥¼ í¬ê²Œ ì¡ìœ¼ë©´ ì¥ì• ë¥¼ ëŠ¦ì¶œ ìˆ˜ëŠ” ìˆì§€ë§Œ, ì¥ì• ê°€ ë‚¬ì„ ë•Œ ë” í¬ê²Œ í„°ì§„ë‹¤.**

### 11. DB ì»¤ë„¥ì…˜ í’€ê¹Œì§€ ê°™ì´ ë³´ë©´ ì™œ ìœ„í—˜í•œì§€ ë³´ì¸ë‹¤

**ì˜ˆì‹œ ìƒí™©:**
```
HikariCP maximumPoolSize = 20 (DB ì»¤ë„¥ì…˜ ìµœëŒ€ 20ê°œ)
ë¹„ë™ê¸° ìŠ¤ë ˆë“œí’€:
  - corePoolSize = 50
  - maxPoolSize = 100
  - queueCapacity = 1000
```

**ë¹„ë™ê¸° ì‘ì—… 500ê°œê°€ ë™ì‹œì— ë“¤ì–´ì˜¤ê³ , ê° ì‘ì—…ì€ DBë¥¼ í•œ ë²ˆì”© ì¡°íšŒí•œë‹¤ë©´?**

**ì‹¤ì œë¡œ ì¼ì–´ë‚˜ëŠ” ì¼:**
1. ìŠ¤ë ˆë“œ 50ê°œ(ì½”ì–´ë§Œí¼)ëŠ” ë°”ë¡œ DB ì»¤ë„¥ì…˜ì„ ë¹Œë¦¬ë ¤ê³  í•¨
2. DB ì»¤ë„¥ì…˜ì€ 20ê°œë¿ì´ë¯€ë¡œ
   - 20ê°œëŠ” DBë¡œ ê°€ê³ 
   - ë‚˜ë¨¸ì§€ 30ê°œëŠ” ì»¤ë„¥ì…˜ í’€ ì•ì—ì„œ ëŒ€ê¸°
3. ê·¸ ë™ì•ˆ ë‚˜ë¨¸ì§€ 450ê°œ ì‘ì—…ë„ ë“¤ì–´ì˜¤ê³  ìˆìŒ
   - íì— ìŒ“ì´ê±°ë‚˜
   - maxPoolSizeê¹Œì§€ ìŠ¤ë ˆë“œë¥¼ ëŠ˜ë¦´ ìˆ˜ë„ ìˆìŒ
4. ê²°êµ­:
   - DBëŠ” í•­ìƒ 20ì»¤ë„¥ì…˜ í’€ë¡œ ê½‰ ì°¨ì„œ ë°”ì¨
   - ë‚˜ë¨¸ì§€ 80ê°œ ìŠ¤ë ˆë“œëŠ” DB ì»¤ë„¥ì…˜ ì–»ìœ¼ë ¤ê³  ì¤„ ì„œ ìˆìŒ
   - CPUëŠ” ìŠ¤ë ˆë“œ 100ê°œë¥¼ ë²ˆê°ˆì•„ê°€ë©° ì „í™˜(context switch) í•˜ëŠë¼ ë°”ì¨
   - ì‹¤ë‚´ ì²˜ë¦¬ ì†ë„ëŠ” ì˜¤íˆë ¤ â†“
   - ì‘ë‹µ ì§€ì—°, íƒ€ì„ì•„ì›ƒ ì¦ê°€
   - ìµœì•…ì—” OOM

**ğŸ’¡ í•µì‹¬:** ë¹„ë™ê¸° ìŠ¤ë ˆë“œë¥¼ ëŠ˜ë¦¬ë©´ **"ì¼ì„ ë¹¨ë¦¬í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, DB ì•ì—ì„œ ì¤„ ì„œ ìˆëŠ” ì‚¬ëŒ ìˆ˜ë§Œ ëŠ˜ì–´ë‚œë‹¤."**

### 12. ê·¸ëŸ¼ ì–´ë–»ê²Œ ì¡ëŠ” ê²Œ ì ë‹¹í•˜ëƒ?

ì •ë‹µì€ **"ë¶€í•˜ í…ŒìŠ¤íŠ¸í•˜ë©´ì„œ ì¡°ì ˆ"**ì´ì§€ë§Œ, ëŒ€ëµì ì¸ ê°ê°:

#### 1) DB ì»¤ë„¥ì…˜ í’€ ê¸°ì¤€ìœ¼ë¡œ ìƒê°í•˜ê¸°

**ì˜ˆ:**
```
DB max pool = 20
ê·¸ëŸ¼ ë™ì‹œì— DBë¥¼ ë•Œë¦´ ìˆ˜ ìˆëŠ” ìµœëŒ€ ìˆ˜ = 20
```

ë¹„ë™ê¸° ì‘ì—…ì´ ëŒ€ë¶€ë¶„ DB/ì™¸ë¶€APIë¥¼ ì“°ë©´:
- `corePoolSize`ë¥¼ DB ì»¤ë„¥ì…˜ í’€ì˜ 1~2ë°° ì •ë„ì—ì„œ ì‹œì‘
  - ì˜ˆ: 20 ~ 40
- `maxPoolSize`ëŠ” coreì˜ 2ë°° ì´ë‚´
  - ì˜ˆ: core=20 â†’ max=40~60
- `queueCapacity`ëŠ” ë„ˆë¬´ í¬ê²Œ ë§ê³ , ìˆ˜ì‹­~ìˆ˜ë°± ì •ë„
  - ì˜ˆ: 100~500

#### 2) CPU ì½”ì–´ ìˆ˜ë„ ê°™ì´ ê³ ë ¤

- CPU ì½”ì–´ê°€ 4ê°œì¸ë° ìŠ¤ë ˆë“œ 200ê°œ ëŒë¦°ë‹¤? â†’ ë¬´ì¡°ê±´ ëŠë ¤ì§
- CPU 8ì½”ì–´ë¼ë©´:
  - I/O bound ì‘ì—…: core 8~32ê¹Œì§€ëŠ” ê´œì°®ì€ í¸
  - pure CPU ì—°ì‚° ì‘ì—…ì´ë©´: coreë¥¼ ì½”ì–´ ìˆ˜ì— ë§ê²Œ (8~16 ì´ë‚´)

#### 3) ê·œì¹™

- **"ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ëŠ˜ë¦¬ê¸° ì „ì—, DB/ì™¸ë¶€ API ìš©ëŸ‰ì„ ë¨¼ì € ì²´í¬í•´ë¼"**
- **"ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ëŠ˜ë¦¬ëŠ” ê±´ 'ë§ˆì§€ë§‰ ìˆ˜ë‹¨'ì´ë‹¤."**
- **"ëª‡ ì²œ ê°œ ë¹„ë™ê¸° ì‘ì—…ì´ í•„ìš”í•˜ë©´ â†’ ê·¸ê±´ Kafka ê°™ì€ ë©”ì‹œì§€ ì‹œìŠ¤í…œ ì˜ì—­ì´ë‹¤."**

### 13. ìš”ì•½ â€“ 3ê°œ ì„¤ì • + DBê¹Œì§€ í•œ ë²ˆì— ê¸°ì–µí•˜ëŠ” ë°©ë²•

| ì„¤ì • | ì˜ë¯¸ | ë¹„ìœ  |
|-----|------|------|
| **corePoolSize** | ë™ì‹œì— ëŒë¦´ ê¸°ë³¸ ì‘ì—…ì ìˆ˜ | "ë‚´ê°€ í•­ìƒ ëŒë¦´ ì§ì› ìˆ˜" |
| **maxPoolSize** | ìœ„ê¸° ë•Œ ì ê¹ ëŠ˜ë¦´ ìˆ˜ ìˆëŠ” ì‘ì—…ì ìˆ˜ | "ìµœëŒ€ë¡œ ì¨ë„ ë˜ëŠ” ì§ì› ìˆ˜ ìƒí•œ" |
| **queueCapacity** | ì¼ì´ ëª°ë ¸ì„ ë•Œ ì ê¹ ìŒ“ì•„ë‘ëŠ” ëŒ€ê¸°ì—´ | "ëŒ€ê¸°ì‹¤ ì˜ì ìˆ˜" |
| **DB Connection Pool** | ë™ì‹œì— DBë‘ ì–˜ê¸°í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ì‚¬ëŒ ìˆ˜ | "DB ì°½êµ¬ ìˆ˜" |

**ğŸ’£ ë¹„ë™ê¸° ìŠ¤ë ˆë“œ ìˆ˜ê°€ DB ì»¤ë„¥ì…˜ ìˆ˜ë³´ë‹¤ í›¨ì”¬ ë§ìœ¼ë©´?**

â†’ ì‚¬ëŒì€ ì”ëœ© ì„œ ìˆê³ , ì°½êµ¬ëŠ” ëª‡ ê°œ ì—†ì–´ì„œ ì¤„ë§Œ ê¸¸ì–´ì§€ëŠ” ìƒí™©
â†’ CPUëŠ” ì‚¬ëŒ ëˆˆì¹˜ ë³´ëŠë¼ ë°”ì˜ê³ , DBëŠ” í•­ìƒ ë²½ë ¥ê°™ì´ ë°”ì¨
â†’ ì„œë¹„ìŠ¤ëŠ” ëŠë ¤ì§ â†’ íƒ€ì„ì•„ì›ƒ â†’ ì¥ì• 

---

## ğŸ¯ ìµœì¢… ê¹¨ë‹¬ìŒ â€” ì‘ì€ ì—ëŸ¬ì—ì„œ ì‹œì‘ëœ í° ë°°ì›€
### 14. ìµœì¢… ì •ë¦¬ â€” í•˜ë‚˜ì˜ íë¦„ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ìˆœê°„

ì´ ëª¨ë“  í•™ìŠµ ê³¼ì •ì„ ê±°ì¹˜ë©´ì„œ, ì²˜ìŒì— ê°€ì¡Œë˜ ì˜ë¬¸ë“¤ì´ í•˜ë‚˜ì”© í•´ê²°ë˜ì—ˆë‹¤.

**"@Asyncë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ë©´ ì •ë§ ì•ˆì „í•œ ê±¸ê¹Œ?"**
â†’ ì•„ë‚˜. ì†Œê·œëª¨ì—ì„œë§Œ ì•ˆì „í•˜ê³ , ê³ íŠ¸ë˜í”½ì—ì„œëŠ” ìœ„í—˜í•˜ë‹¤.

**"ìŠ¤ë ˆë“œê°€ ë§ìœ¼ë©´ ì„±ëŠ¥ì´ ì¢‹ì•„ì§€ëŠ” ê±° ì•„ë‹Œê°€?"**
â†’ ì•„ë‚˜. CPU ì½”ì–´ ìˆ˜ ì´ìƒìœ¼ë¡œ ëŠ˜ë¦¬ë©´ ì˜¤íˆë ¤ ëŠë ¤ì§„ë‹¤.

**"ê·¸ëŸ¼ ì™œ ì‚¬ëŒë“¤ì€ Kafka ê°™ì€ ë³µì¡í•œ ì‹œìŠ¤í…œì„ ì“°ëŠ” ê±°ì§€?"**
â†’ ìŠ¤ë ˆë“œ ê¸°ë°˜ ë¹„ë™ê¸°ì˜ í•œê³„ë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í•˜ê¸° ìœ„í•´ì„œë‹¤.

#### í•µì‹¬ ì›ì¹™ 5ê°€ì§€

**â­ CPU ì½”ì–´ = ë™ì‹œì— ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜**
- 8ì½”ì–´ë©´ ë™ì‹œì— 8ê°œë§Œ ì‹¤í–‰ ê°€ëŠ¥
- ë‚˜ë¨¸ì§€ëŠ” ì¤„ ì„œì„œ ëŒ€ê¸°

**â­ ìŠ¤ë ˆë“œê°€ ë§ì•„ì§€ë©´ ì˜¤íˆë ¤ ëŠë ¤ì§„ë‹¤**
- Context switching ë¹„ìš©
- ë©”ëª¨ë¦¬ ì¦ê°€
- DB ì»¤ë„¥ì…˜ í’€ ë³‘ëª©

**â­ @AsyncëŠ” ê³ ë™ì‹œì„±ì—ì„œ ì ˆëŒ€ ì“°ë©´ ì•ˆ ëœë‹¤**
- ìŠ¤ë ˆë“œí’€ ê³ ê°ˆ
- ì‘ì—… ìœ ì‹¤
- ì„œë²„ ë‹¤ìš´ ìœ„í—˜

**â­ ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤**
- í•µì‹¬ ë¡œì§ê³¼ ë¶€ê°€ ë¡œì§ ë¶„ë¦¬
- ì™¸ë¶€ API ì‹¤íŒ¨ê°€ ë©”ì¸ ë¡œì§ì— ì˜í–¥ ì•ˆ ì¤Œ
- ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ

**â­ KafkaëŠ” ìŠ¤ë ˆë“œ ê¸°ë°˜ ë¹„ë™ê¸°ì˜ í•œê³„ë¥¼ í•´ê²°í•˜ëŠ” ê¸°ìˆ ì´ë‹¤**
- ë””ìŠ¤í¬ ê¸°ë°˜ ì €ì¥
- ìƒì‚°/ì†Œë¹„ ì†ë„ ë…ë¦½
- ì¬ì²˜ë¦¬ ê°€ëŠ¥
- ìˆ˜í‰ í™•ì¥

#### ê°œë°œì ì¸ìƒ ì „ì²´ì— ë„ì›€ì´ ë˜ëŠ” í†µì°°

ì´ ëª¨ë“  ë‚´ìš©ì„ ì´í•´í•˜ë©´:
- **ìŠ¤ë ˆë“œ**ì™€ **CPU**ì˜ ê´€ê³„
- **ë¹„ë™ê¸° ì²˜ë¦¬**ì˜ ë³¸ì§ˆê³¼ í•œê³„
- **@Async**ë¥¼ ì–¸ì œ ì“°ê³  ì–¸ì œ ì“°ë©´ ì•ˆ ë˜ëŠ”ì§€
- **Kafka** ê°™ì€ ë©”ì‹œì§€ ë¸Œë¡œì»¤ê°€ í•„ìš”í•œ ì´ìœ 
- **EDA**(ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜)ì˜ ê°€ì¹˜
- **ë™ì‹œì„± ë³‘ëª©**ì´ ë°œìƒí•˜ëŠ” ì›ë¦¬
- **ì„œë²„ ì¥ì• **ì˜ ê·¼ë³¸ ì›ì¸

**ì´ ëª¨ë“  ê²Œ í•˜ë‚˜ì˜ íë¦„ìœ¼ë¡œ ì—°ê²°ëœë‹¤.**


---

## ì—í•„ë¡œê·¸

ë‹¨ìˆœíˆ "ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ì—ëŸ¬ í•˜ë‚˜ë¥¼ í•´ê²°í•˜ë ¤ê³  ì‹œì‘í–ˆë˜ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì´ì—ˆë‹¤.

ê·¸ëŸ°ë° íŒŒê³ ë“¤ë‹¤ ë³´ë‹ˆ:
- @Asyncê°€ ì™œ ìœ„í—˜í•œì§€
- ìŠ¤ë ˆë“œì™€ CPUì˜ ê´€ê³„ëŠ” ë¬´ì—‡ì¸ì§€  
- Kafkaê°€ ì™œ í•„ìš”í•œì§€
- ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì€ ì–´ë–»ê²Œ ì„¤ê³„í•´ì•¼ í•˜ëŠ”ì§€

ì´ ëª¨ë“  ê²ƒì´ í•˜ë‚˜ì˜ ë§¥ë½ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ìˆœê°„ì„ ê²½í—˜í–ˆë‹¤.

**ì—ëŸ¬ í•˜ë‚˜ê°€ ë‚˜ë¥¼ ì—¬ê¸°ê¹Œì§€ ë°ë ¤ì™”ë‹¤.**

ì´ê²ƒì´ ë°”ë¡œ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì˜ ì§„ì§œ ê°€ì¹˜ê°€ ì•„ë‹ê¹Œ.

ë¬¸ì œë¥¼ íšŒí”¼í•˜ì§€ ì•Šê³  ëê¹Œì§€ íŒŒê³ ë“¤ë©´,  
ë‹¨ìˆœí•œ í•´ê²°ì„ ë„˜ì–´ì„œ **ë³¸ì§ˆì ì¸ ì´í•´**ì— ë„ë‹¬í•˜ê²Œ ëœë‹¤.

ì•ìœ¼ë¡œë„ ì´ëŸ° íƒœë„ë¡œ ê°œë°œí•´ ë‚˜ê°€ê³  ì‹¶ë‹¤.
