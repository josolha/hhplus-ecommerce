# E-Commerce ì¸ê¸° ìƒí’ˆ ì¡°íšŒ ì¿¼ë¦¬ ìµœì í™”

> MySQL ì¸ë±ìŠ¤ ì„¤ê³„ ë° EXPLAIN ë¶„ì„ì„ í†µí•œ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„  (4ë‹¨ê³„ ì‹¤í—˜)

---

## ğŸ“‹ ëª©ì°¨

- [ë°°ê²½](#-ë°°ê²½)
- [ëŒ€ìƒ ì¿¼ë¦¬](#-ëŒ€ìƒ-ì¿¼ë¦¬)
- [ìµœì í™” ê³¼ì •](#-ìµœì í™”-ê³¼ì •)
  - [1ë‹¨ê³„: ì¸ë±ìŠ¤ ì—†ìŒ](#-1ë‹¨ê³„-ì¸ë±ìŠ¤-ì—†ìŒ-ì´ˆê¸°-ìƒíƒœ)
  - [2ë‹¨ê³„: orders ì¸ë±ìŠ¤ë§Œ ì¶”ê°€](#-2ë‹¨ê³„-orders-í…Œì´ë¸”ì—ë§Œ-ì¸ë±ìŠ¤-ì¶”ê°€)
  - [3ë‹¨ê³„: order_items ì¸ë±ìŠ¤ ì¶”ê°€](#-3ë‹¨ê³„-order_items-ì¸ë±ìŠ¤-ì¶”ê°€)
  - [4ë‹¨ê³„: Covering Index ì‹¤í—˜](#-4ë‹¨ê³„-covering-index-ì‹¤í—˜)
- [ìµœì¢… ì„ íƒ ë° ë¹„êµ](#-ìµœì¢…-ì„ íƒ-ë°-ë¹„êµ)
- [í•µì‹¬ êµí›ˆ](#-í•µì‹¬-êµí›ˆ)
- [ì‹¤í–‰ ê³„íš ìš©ì–´ ì„¤ëª…](#-ì‹¤í–‰-ê³„íš-ìš©ì–´-ì„¤ëª…)
- [ì¶”ê°€ ì¸ë±ìŠ¤ ì„¤ê³„](#ï¸-ì¶”ê°€-ì¸ë±ìŠ¤-ì„¤ê³„)

---

## ğŸ“Œ ë°°ê²½

ì¸ê¸° ìƒí’ˆ ì¡°íšŒ ì¿¼ë¦¬ì˜ ì„±ëŠ¥ ë¬¸ì œë¥¼ ë°œê²¬í•˜ê³ , **EXPLAIN/EXPLAIN ANALYZE**ë¥¼ í†µí•´ ì‹¤í–‰ ê³„íšì„ ë¶„ì„í•œ í›„ ì¸ë±ìŠ¤ ìµœì í™”ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

**ë¬¸ì œ ìƒí™©:**
- ìµœê·¼ 3ì¼ê°„ ì™„ë£Œëœ ì£¼ë¬¸ ì¤‘ ì¸ê¸° ìƒí’ˆ Top 5 ì¡°íšŒ
- ì´ˆê¸° ì‹¤í–‰ ì‹œê°„: **2,930ms** (ì•½ 2.93ì´ˆ)
- 400,000ê±´ì˜ order_items ì „ì²´ ìŠ¤ìº” ë°œìƒ

**ëª©í‘œ:**
- ì‹¤í–‰ ê³„íš ë¶„ì„ì„ í†µí•œ ë³‘ëª© ì§€ì  íŒŒì•…
- ì ì ˆí•œ ì¸ë±ìŠ¤ ì„¤ê³„ë¡œ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„ 

---

## ğŸ” ëŒ€ìƒ ì¿¼ë¦¬

```sql
SELECT
    pd.id,
    pd.name,
    pd.price,
    pd.stock,
    pd.category,
    SUM(oi.quantity) as total_quantity
FROM order_items oi
JOIN orders o ON oi.order_id = o.id
JOIN products pd ON oi.product_id = pd.id
WHERE o.created_at >= DATE_SUB(NOW(), INTERVAL 3 DAY)
  AND o.status = 'COMPLETED'
GROUP BY pd.id, pd.name, pd.price, pd.stock, pd.category, pd.created_at
ORDER BY SUM(oi.quantity) DESC, MAX(o.created_at) DESC, pd.created_at DESC
LIMIT 5;
```

**ì¿¼ë¦¬ ë¶„ì„:**
- 3ê°œ í…Œì´ë¸” JOIN (order_items, orders, products)
- WHERE ì¡°ê±´: ë‚ ì§œ ë²”ìœ„ + ìƒíƒœ í•„í„°
- GROUP BY + ORDER BY + LIMIT 5

---

## ğŸš€ ìµœì í™” ê³¼ì •

### ğŸ” 1ë‹¨ê³„: ì¸ë±ìŠ¤ ì—†ìŒ (ì´ˆê¸° ìƒíƒœ)

#### ì‹¤í–‰ ê³„íš (EXPLAIN)
```
id  table  type  rows     Extra
1   oi     ALL   423,560  Using temporary; Using filesort
1   pd     eq_ref    1    NULL
1   o      eq_ref    1    Using where
```

#### ì‹¤ì œ ì„±ëŠ¥ (EXPLAIN ANALYZE)
```
-> Table scan on oi (actual time=5.68..638ms, rows=400,000 loops=1)
   -> Filter: status='COMPLETED' AND created_at>=... (loops=400,000)

Total: 2,930ms (ì•½ 2.93ì´ˆ)
```

#### ë¬¸ì œì 
- âŒ **order_items ì „ì²´ ìŠ¤ìº”**: 400,000ê±´ ì½ê¸°
- âŒ **400,000ë²ˆ í•„í„°ë§**: WHERE ì¡°ê±´ì„ ë§¤ë²ˆ ì²´í¬
- âŒ **ë¹„íš¨ìœ¨ì  JOIN ìˆœì„œ**: order_items â†’ products â†’ orders

---

### ğŸ”§ 2ë‹¨ê³„: orders í…Œì´ë¸”ì—ë§Œ ì¸ë±ìŠ¤ ì¶”ê°€

#### ì¶”ê°€í•œ ì¸ë±ìŠ¤
```sql
CREATE INDEX idx_orders_status_created_at ON orders(status, created_at);
```

#### ì„¤ê³„ ê·¼ê±°
```
1. WHERE ì ˆ ë¶„ì„:
   - status = 'COMPLETED' (ë“±í˜¸ ì¡°ê±´)
   - created_at >= 3ì¼ì „ (ë²”ìœ„ ì¡°ê±´)

2. ì¸ë±ìŠ¤ ì»¬ëŸ¼ ìˆœì„œ:
   - status â†’ created_at (ë“±í˜¸ ë¨¼ì €, ë²”ìœ„ ë‚˜ì¤‘)
   - MySQL ì¸ë±ìŠ¤ í™œìš© ì›ì¹™ ì¤€ìˆ˜

3. ì˜ˆìƒ í•„í„°ë§ íš¨ê³¼:
   - 200,000ê±´ â†’ 12,000ê±´ (94% ê°ì†Œ)
```

#### ê²°ê³¼
```
Total: 4,584ms (âŒ ì˜¤íˆë ¤ 56% ì•…í™”!)
```

#### ì™œ ì‹¤íŒ¨í–ˆë‚˜?
```
[ì‹¤í–‰ ê³„íš ë³€í™” ì—†ìŒ]
ì—¬ì „íˆ: order_items â†’ products â†’ orders

[ê·¼ë³¸ ì›ì¸]
- MySQL ì˜µí‹°ë§ˆì´ì €ê°€ order_itemsë¥¼ ë¨¼ì € ìŠ¤ìº”í•˜ëŠ” ì „ëµ ìœ ì§€
- ordersì˜ ì¸ë±ìŠ¤ê°€ WHERE í•„í„°ë§ì— ì‚¬ìš©ë˜ì§€ ëª»í•¨
- 400,000ë²ˆì˜ ë‹¨ê±´ ì¡°íšŒ í›„ ê°ê° í•„í„°ë§ ìˆ˜í–‰

[êµí›ˆ]
ë‹¨ì¼ í…Œì´ë¸” ì¸ë±ìŠ¤ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±!
JOIN ìˆœì„œë¥¼ ë°”ê¾¸ë ¤ë©´ ëª¨ë“  í…Œì´ë¸”ì— ì¸ë±ìŠ¤ í•„ìš”
```

---

### âœ… 3ë‹¨ê³„: order_items ì¸ë±ìŠ¤ ì¶”ê°€

#### ì¶”ê°€í•œ ì¸ë±ìŠ¤
```sql
-- orders í…Œì´ë¸” (ê¸°ì¡´)
CREATE INDEX idx_orders_status_created_at ON orders(status, created_at);

-- order_items í…Œì´ë¸” (ì‹ ê·œ)
CREATE INDEX idx_order_items_order_id ON order_items(order_id);
CREATE INDEX idx_order_items_product_id ON order_items(product_id);
```

#### ì„¤ê³„ ê·¼ê±°
```
1. JOIN ì¡°ê±´ ë¶„ì„:
   - JOIN orders o ON oi.order_id = o.id
   - JOIN products pd ON oi.product_id = pd.id
   â†’ order_itemsê°€ ë‘ í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ë¯€ë¡œ ë‘ ì»¬ëŸ¼ ëª¨ë‘ ì¸ë±ìŠ¤ í•„ìš”

2. ì˜ˆìƒ íš¨ê³¼:
   - MySQL ì˜µí‹°ë§ˆì´ì €ê°€ JOIN ìˆœì„œ ë³€ê²½ ê°€ëŠ¥
   - orders â†’ order_items â†’ products ìˆœì„œë¡œ ì‹¤í–‰
   - ordersì˜ ì¸ë±ìŠ¤ê°€ ë¹„ë¡œì†Œ í™œìš©ë¨
```

#### ì‹¤í–‰ ê³„íš (EXPLAIN)
```
id  table  type   key                           rows   Extra
1   o      range  idx_orders_status_created_at  24,708 Using where; Using index
1   oi     ref    idx_order_items_order_id      2      NULL
1   pd     eq_ref PRIMARY                       1      NULL
```

âœ… **JOIN ìˆœì„œ ë³€ê²½**: orders â†’ order_items â†’ products
âœ… **ëª¨ë“  í…Œì´ë¸”ì—ì„œ ì¸ë±ìŠ¤ ì‚¬ìš©!**

#### ì‹¤ì œ ì„±ëŠ¥ (EXPLAIN ANALYZE)
```
-> Covering index range scan on o using idx_orders_status_created_at
   (actual time=0.123..3.58ms, rows=11,992 loops=1)
   -> Index lookup on oi using idx_order_items_order_id
      (actual time=0.0595..0.0599ms, rows=2 loops=11,992)
      -> Single-row index lookup on pd using PRIMARY
         (actual time=0.00211..0.00213ms, rows=1 loops=23,984)

Total: 840ms (âœ… 71.3% ê°œì„ !)
```

#### ê°œì„  ì‚¬í•­
- âœ… **ì‹¤í–‰ ì‹œê°„**: 2,930ms â†’ 840ms (71.3% ê°œì„ , ì•½ 3.5ë°° ë¹ ë¦„)
- âœ… **ì²˜ë¦¬ ë°ì´í„°**: 400,000ê±´ â†’ 11,992ê±´ (97% ê°ì†Œ)
- âœ… **í•„í„°ë§ ë°˜ë³µ**: 400,000ë²ˆ â†’ 11,992ë²ˆ (97% ê°ì†Œ)
- âœ… **Covering Index**: ì¸ë±ìŠ¤ë§Œìœ¼ë¡œ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ (ë””ìŠ¤í¬ I/O ìµœì†Œí™”)

---

### ğŸ§ª 4ë‹¨ê³„: Covering Index ì‹¤í—˜

#### ê°€ì„¤
3ë‹¨ê³„ì—ì„œ 2ê°œ ë‹¨ì¼ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í–ˆëŠ”ë°, ë³µí•© Covering Indexë¥¼ ì‚¬ìš©í•˜ë©´ ë” ë¹ ë¥¼ê¹Œ?

**Covering Indexë€?**
- ì¿¼ë¦¬ì—ì„œ í•„ìš”í•œ ëª¨ë“  ì»¬ëŸ¼ì„ ì¸ë±ìŠ¤ì— í¬í•¨
- í…Œì´ë¸” ë°ì´í„°ì— ì ‘ê·¼í•˜ì§€ ì•Šê³  ì¸ë±ìŠ¤ë§Œìœ¼ë¡œ ì¿¼ë¦¬ ì²˜ë¦¬
- EXPLAINì—ì„œ "Using index" í‘œì‹œ

#### ë³€ê²½í•œ ì¸ë±ìŠ¤
```sql
-- 3ë‹¨ê³„ ì¸ë±ìŠ¤ ì œê±°
DROP INDEX idx_order_items_order_id ON order_items;
DROP INDEX idx_order_items_product_id ON order_items;

-- Covering Index ìƒì„±
CREATE INDEX idx_order_items_order_id_product_id_quantity
ON order_items(order_id, product_id, quantity);
```

#### ì„¤ê³„ ê·¼ê±°
```
ì¿¼ë¦¬ì—ì„œ order_itemsì˜ ì‚¬ìš© ì»¬ëŸ¼:
1. order_id - JOIN ì¡°ê±´
2. product_id - JOIN ì¡°ê±´
3. quantity - SUM ì§‘ê³„

â†’ 3ê°œ ì»¬ëŸ¼ì„ ëª¨ë‘ ì¸ë±ìŠ¤ì— í¬í•¨í•˜ë©´ í…Œì´ë¸” ì ‘ê·¼ ë¶ˆí•„ìš”!

ì˜ˆìƒ íš¨ê³¼:
âœ… í…Œì´ë¸” ëœë¤ ì•¡ì„¸ìŠ¤ ì œê±° (ë””ìŠ¤í¬ I/O ê°ì†Œ)
âœ… ì¸ë±ìŠ¤ë§Œìœ¼ë¡œ ë°ì´í„° ì¡°íšŒ (ë©”ëª¨ë¦¬ íš¨ìœ¨)
```

#### ì‹¤í–‰ ê³„íš (EXPLAIN)
```
id  table  type   key                                      rows   Extra
1   o      range  idx_orders_status_created_at             24,708 Using index
1   oi     ref    idx_order_items_order_id_product_id_qty  2      Using index âœ…
1   pd     eq_ref PRIMARY                                  1      NULL
```

âœ… **"Using index" í‘œì‹œ - Covering Index ì‘ë™!**

#### ì‹¤ì œ ì„±ëŠ¥ (EXPLAIN ANALYZE)
```
-> Covering index lookup on oi using idx_order_items_order_id_product_id_quantity
   (actual time=0.0702..0.0709ms, rows=2 loops=11,992)

Total: 1,017ms (âŒ 21% ëŠë ¤ì§!)
```

#### ê²°ê³¼ ë¶„ì„

**ì™œ Covering Indexê°€ ë” ëŠë¦´ê¹Œ?**

1. **ì¸ë±ìŠ¤ í¬ê¸° ì¦ê°€**
   - Covering Index: 3ê°œ ì»¬ëŸ¼ (order_id, product_id, quantity)
   - ë‹¨ì¼ ì¸ë±ìŠ¤: 1ê°œ ì»¬ëŸ¼ (order_id)
   - â†’ ì¸ë±ìŠ¤ ìì²´ê°€ ì»¤ì ¸ì„œ ìŠ¤ìº” ë¹„ìš© ì¦ê°€

2. **ì¡°ì¸ íšŸìˆ˜ê°€ ì ìŒ**
   - ì´ ì¿¼ë¦¬ëŠ” 11,992ë²ˆë§Œ ì¡°ì¸ (ì „ì²´ì˜ 3%)
   - í…Œì´ë¸” ëœë¤ ì•¡ì„¸ìŠ¤ê°€ ë§ì§€ ì•Šì•„ Covering Index ì´ì  ë¯¸ë¯¸
   - ì˜¤íˆë ¤ ë³µì¡í•œ ì¸ë±ìŠ¤ êµ¬ì¡°ê°€ ì˜¤ë²„í—¤ë“œ

3. **InnoDB í´ëŸ¬ìŠ¤í„°ë“œ ì¸ë±ìŠ¤ íŠ¹ì„±**
   - InnoDBëŠ” ì„¸ì»¨ë”ë¦¬ ì¸ë±ìŠ¤ì—ì„œ PKë¡œ ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥ (ë§¤ìš° ë¹ ë¦„)
   - order_itemsê°€ ë¹„êµì  ì‘ì€ í…Œì´ë¸”ì´ë¼ í…Œì´ë¸” ì•¡ì„¸ìŠ¤ ë¹„ìš© ë‚®ìŒ

4. **ìºì‹± íš¨ê³¼**
   - 11,992ë²ˆì˜ í…Œì´ë¸” ì•¡ì„¸ìŠ¤ëŠ” ëŒ€ë¶€ë¶„ ë²„í¼ í’€ì—ì„œ ì²˜ë¦¬
   - Covering Indexì˜ ë””ìŠ¤í¬ I/O ì ˆê° íš¨ê³¼ê°€ ë¯¸ë¯¸

#### ì–¸ì œ Covering Indexê°€ ìœ ë¦¬í•œê°€?

âœ… **ìœ ë¦¬í•œ ê²½ìš°:**
- ì¡°ì¸ íšŸìˆ˜ê°€ ë§¤ìš° ë§ì„ ë•Œ (ìˆ˜ì‹­ë§Œ~ìˆ˜ë°±ë§Œ ê±´)
- í…Œì´ë¸”ì´ ë§¤ìš° í´ ë•Œ (ë²„í¼ í’€ì— ìºì‹± ì•ˆ ë¨)
- SELECT ì»¬ëŸ¼ì´ ë§ê³  ë³µì¡í•œ ì§‘ê³„ ì‹œ
- ì½ê¸° ì „ìš© ì¿¼ë¦¬ê°€ ì••ë„ì ìœ¼ë¡œ ë§ì„ ë•Œ

âŒ **ë¶ˆë¦¬í•œ ê²½ìš°:**
- ì¡°ì¸ íšŸìˆ˜ê°€ ì ì„ ë•Œ (1ë§Œ ê±´ ë‚´ì™¸) â† í˜„ì¬ ìƒí™©
- ì¸ë±ìŠ¤ í¬ê¸°ê°€ ì§€ë‚˜ì¹˜ê²Œ ì»¤ì§ˆ ë•Œ
- INSERT/UPDATEê°€ ë¹ˆë²ˆí•œ í…Œì´ë¸”
- ë‹¨ìˆœí•œ ì§‘ê³„ë§Œ ìˆ˜í–‰í•  ë•Œ

---

## ğŸ“Š ìµœì¢… ì„ íƒ ë° ë¹„êµ

### 4ë‹¨ê³„ ìµœì í™” ì—¬ì •

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ë‹¨ê³„: ì¸ë±ìŠ¤ ì—†ìŒ                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì‹¤í–‰ ì‹œê°„: 2,930ms                                               â”‚
â”‚ ì‹¤í–‰ ê³„íš: order_items(ALL) â†’ products â†’ orders                  â”‚
â”‚ ì²˜ë¦¬ ë°ì´í„°: 400,000 rows ì „ì²´ ìŠ¤ìº”                              â”‚
â”‚ ë¬¸ì œì : Full Table Scan + 400,000ë²ˆ WHERE í•„í„°ë§                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ë‹¨ê³„: orders ì¸ë±ìŠ¤ë§Œ ì¶”ê°€                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì‹¤í–‰ ì‹œê°„: 4,584ms (âŒ 56% ì•…í™”!)                                â”‚
â”‚ ì‹¤í–‰ ê³„íš: order_items(ALL) â†’ products â†’ orders (ë³€í™” ì—†ìŒ)      â”‚
â”‚ ì¸ë±ìŠ¤: idx_orders_status_created_at (ì¸ì‹ë˜ë‚˜ ë¯¸ì‚¬ìš©)           â”‚
â”‚ ë¬¸ì œì : JOIN ìˆœì„œê°€ ë°”ë€Œì§€ ì•Šì•„ ì¸ë±ìŠ¤ í™œìš© ë¶ˆê°€                â”‚
â”‚ êµí›ˆ: ë‹¨ì¼ í…Œì´ë¸” ì¸ë±ìŠ¤ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±!                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ë‹¨ê³„: order_items ì¸ë±ìŠ¤ ì¶”ê°€ â­ ìµœì !                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¸ë±ìŠ¤: idx_order_items_order_id (order_id)                      â”‚
â”‚        idx_order_items_product_id (product_id)                   â”‚
â”‚ ì‹¤í–‰ ì‹œê°„: 840ms (âœ… 71.3% ê°œì„ !)                                â”‚
â”‚ ì‹¤í–‰ ê³„íš: orders(range) â†’ order_items(ref) â†’ products(eq_ref)  â”‚
â”‚ ì²˜ë¦¬ ë°ì´í„°: 11,992 rows (97% ê°ì†Œ)                              â”‚
â”‚ ì„±ê³µ ìš”ì¸: ëª¨ë“  í…Œì´ë¸”ì— ì ì ˆí•œ ì¸ë±ìŠ¤ â†’ ì˜µí‹°ë§ˆì´ì € ìµœì  ê²½ë¡œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ë‹¨ê³„: Covering Index ì‹¤í—˜                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¸ë±ìŠ¤: idx_order_items_order_id_product_id_quantity (ë³µí•©)      â”‚
â”‚ ì‹¤í–‰ ì‹œê°„: 1,017ms (âŒ 21% ëŠë ¤ì§!)                              â”‚
â”‚ ì‹¤í–‰ ê³„íš: "Using index" í‘œì‹œ (Covering Index ì‘ë™)             â”‚
â”‚ ë¬¸ì œì : ì¸ë±ìŠ¤ í¬ê¸° ì¦ê°€ + ì¡°ì¸ íšŸìˆ˜ ì ì–´ ì´ì  ë¯¸ë¯¸             â”‚
â”‚ êµí›ˆ: ì´ë¡ ì  ìµœì í™” â‰  ì‹¤ì œ ì„±ëŠ¥, ë°˜ë“œì‹œ ì‹¤ì¸¡ í•„ìš”!              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                      â­ 3ë‹¨ê³„ ì„ íƒ â­
```

### ì„±ëŠ¥ ë¹„êµí‘œ

| ë‹¨ê³„ | ì¸ë±ìŠ¤ êµ¬ì¡° | ì‹¤í–‰ ì‹œê°„ | ê°œì„ ìœ¨ | ì„ íƒ |
|------|------------|----------|--------|------|
| 1ë‹¨ê³„ (ì¸ë±ìŠ¤ X) | ì—†ìŒ | 2,930ms | ê¸°ì¤€ | âŒ |
| 2ë‹¨ê³„ (ordersë§Œ) | orders ë³µí•© | 4,584ms | -56% | âŒ ì•…í™” |
| 3ë‹¨ê³„ (ë¶„ë¦¬) | orders ë³µí•© + order_items ë‹¨ì¼ 2ê°œ | **840ms** | **+71.3%** | âœ… **ìµœì¢…** |
| 4ë‹¨ê³„ (í†µí•©) | orders ë³µí•© + order_items ë³µí•© | 1,017ms | +65.3% | âŒ ëŠë¦¼ |

### ìµœì¢… ì„ íƒ: 3ë‹¨ê³„ (ë‹¨ì¼ ì¸ë±ìŠ¤)

**ì„ íƒí•œ ì¸ë±ìŠ¤:**
```sql
-- orders í…Œì´ë¸”
CREATE INDEX idx_orders_status_created_at ON orders(status, created_at);

-- order_items í…Œì´ë¸”
CREATE INDEX idx_order_items_order_id ON order_items(order_id);
CREATE INDEX idx_order_items_product_id ON order_items(product_id);
```

**ì„ íƒ ì´ìœ :**
1. **ì„±ëŠ¥**: 840ms (Covering Index 1017msë³´ë‹¤ 21% ë¹ ë¦„)
2. **ìœ ì§€ë³´ìˆ˜**: 2ê°œ ë‹¨ì¼ ì¸ë±ìŠ¤ê°€ ê´€ë¦¬ ìš©ì´
3. **ì“°ê¸° ì„±ëŠ¥**: order_itemsëŠ” ì£¼ë¬¸ë§ˆë‹¤ INSERT ë°œìƒ â†’ ì¸ë±ìŠ¤ ê°„ë‹¨í• ìˆ˜ë¡ ìœ ë¦¬
4. **ìœ ì—°ì„±**: product_id ë‹¨ë… ì¡°íšŒì—ë„ ì¸ë±ìŠ¤ í™œìš© ê°€ëŠ¥
5. **ê³µê°„ íš¨ìœ¨**: 2ê°œ ë‹¨ì¼ ì¸ë±ìŠ¤ê°€ 1ê°œ ë³µí•© ì¸ë±ìŠ¤ë³´ë‹¤ íš¨ìœ¨ì 

**í•µì‹¬ êµí›ˆ:**
- âœ… Covering Indexê°€ í•­ìƒ ë¹ ë¥¸ ê²ƒì€ ì•„ë‹˜
- âœ… ì‹¤ì œ ë°ì´í„°ì™€ ì¿¼ë¦¬ íŒ¨í„´ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•„ìˆ˜
- âœ… ì´ë¡ ì  ìµœì í™” < ì‹¤ì¸¡ ê¸°ë°˜ ê²°ì •
```

---

## ğŸ“ í•µì‹¬ êµí›ˆ

### 1. ì¸ë±ìŠ¤ ì„¤ê³„ ì›ì¹™
```
âœ… WHERE ì ˆ ì»¬ëŸ¼: ë“±í˜¸(=) ì¡°ê±´ â†’ ë²”ìœ„(>=, <=) ì¡°ê±´ ìˆœì„œ
âœ… JOIN ì»¬ëŸ¼: ì–‘ìª½ í…Œì´ë¸” ëª¨ë‘ ì¸ë±ìŠ¤ í•„ìš”
âœ… ë³µí•© ì¸ë±ìŠ¤: Left-most prefix rule ê³ ë ¤
âŒ ë‹¨ì¼ í…Œì´ë¸”ë§Œ ê³ ë ¤í•˜ë©´ ì‹¤íŒ¨, ì „ì²´ JOIN ì „ëµ ê³ ë ¤ í•„ìˆ˜
```

### 2. MySQL ì˜µí‹°ë§ˆì´ì € ì´í•´
```
- ì˜µí‹°ë§ˆì´ì €ëŠ” ë¹„ìš©(cost) ê¸°ë°˜ìœ¼ë¡œ JOIN ìˆœì„œ ê²°ì •
- ì¸ë±ìŠ¤ê°€ ìˆì–´ë„ í…Œì´ë¸” ì „ì²´ ìŠ¤ìº”ì´ ë” ì €ë ´í•˜ë©´ ì‚¬ìš© ì•ˆ í•¨
- ì—¬ëŸ¬ í…Œì´ë¸” ì¸ë±ìŠ¤ê°€ ê°–ì¶°ì ¸ì•¼ ìµœì  ì‹¤í–‰ ê³„íš ì„ íƒ ê°€ëŠ¥
- ì¸ë±ìŠ¤ ì¶”ê°€ ì‹œ ì‹¤í–‰ ê³„íšì´ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ (2ë‹¨ê³„ ì‚¬ë¡€)
```

### 3. ì‹¤ì¸¡ì˜ ì¤‘ìš”ì„±
```
âŒ ì´ë¡ ì  ìµœì í™” â‰  ì‹¤ì œ ì„±ëŠ¥
âœ… EXPLAIN ANALYZEë¡œ ì‹¤ì¸¡ í•„ìˆ˜
âœ… Covering Indexë„ í•­ìƒ ë¹ ë¥¸ ê²ƒì€ ì•„ë‹˜ (4ë‹¨ê³„ ì‚¬ë¡€)
âœ… ë°ì´í„°ëŸ‰, ìºì‹±, í…Œì´ë¸” í¬ê¸° ë“± ë³µí•© ìš”ì¸ ê³ ë ¤
```

### 4. ì„±ëŠ¥ ìµœì í™” í”„ë¡œì„¸ìŠ¤
```
â‘  EXPLAINìœ¼ë¡œ í˜„ì¬ ì‹¤í–‰ ê³„íš íŒŒì•…
â‘¡ ë³‘ëª© ì§€ì  ì‹ë³„ (Full Scan, ë†’ì€ rows)
â‘¢ WHERE/JOIN ì¡°ê±´ ëª¨ë‘ ê³ ë ¤í•œ ì¸ë±ìŠ¤ ì„¤ê³„
â‘£ EXPLAIN ANALYZEë¡œ ì‹¤ì œ ì„±ëŠ¥ ì¸¡ì •
â‘¤ ì‹¤í–‰ ê³„íšì´ ë°”ë€Œì§€ ì•Šìœ¼ë©´ ì¶”ê°€ ì¸ë±ìŠ¤ ê²€í† 
â‘¥ ì—¬ëŸ¬ ì „ëµì„ ë¹„êµ í…ŒìŠ¤íŠ¸í•˜ì—¬ ìµœì ì•ˆ ì„ íƒ
```

### 5. ì´ í”„ë¡œì íŠ¸ì—ì„œ ë°°ìš´ ì 
```
âŒ 2ë‹¨ê³„: orders ì¸ë±ìŠ¤ë§Œìœ¼ë¡œëŠ” ë¶€ì¡± (JOIN ìˆœì„œê°€ ë°”ë€Œì§€ ì•ŠìŒ)
âœ… 3ë‹¨ê³„: order_items ì¸ë±ìŠ¤ê°€ ì¶”ê°€ë˜ì–´ì•¼ ordersê°€ ë¨¼ì € ì‹¤í–‰ë¨
âœ… 3ë‹¨ê³„: ëª¨ë“  ì¡°ì¸ í…Œì´ë¸”ì— ì ì ˆí•œ ì¸ë±ìŠ¤ê°€ ìˆì–´ì•¼ ì‹œë„ˆì§€ íš¨ê³¼
âŒ 4ë‹¨ê³„: Covering Indexê°€ ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ (ì‹¤ì¸¡ìœ¼ë¡œ ê²€ì¦)
âœ… ìµœì¢…: 71.3% ì„±ëŠ¥ ê°œì„  = 3ê°œ ì¸ë±ìŠ¤ì˜ í˜‘ì—… ê²°ê³¼
```

### 6. íŠ¸ë ˆì´ë“œì˜¤í”„ ê³ ë ¤
```
- ì½ê¸° ì„±ëŠ¥ vs ì“°ê¸° ì„±ëŠ¥
- ì¸ë±ìŠ¤ ê°œìˆ˜ vs ê´€ë¦¬ ë³µì¡ë„
- ê³µê°„ íš¨ìœ¨ vs ì¡°íšŒ ì†ë„
- ì´ë¡ ì  ì™„ë²½í•¨ vs ì‹¤ë¬´ ì í•©ì„±
```

---

## ğŸ“ ì‹¤í–‰ ê³„íš ìš©ì–´ ì„¤ëª…

| ìš©ì–´ | ì„¤ëª… | ì„±ëŠ¥ |
|------|------|------|
| **type: ALL** | ì „ì²´ í…Œì´ë¸” ìŠ¤ìº” | âŒ ìµœì•… |
| **type: range** | ì¸ë±ìŠ¤ ë²”ìœ„ ìŠ¤ìº” | âœ… ì–‘í˜¸ |
| **type: ref** | ì¸ë±ìŠ¤ë¥¼ í†µí•œ ë™ë“± ë¹„êµ | âœ… ì¢‹ìŒ |
| **type: eq_ref** | PRIMARY/UNIQUE í‚¤ë¥¼ í†µí•œ ì¡°ì¸ | âœ… ìµœìƒ |
| **Using index** | Covering Index (ì¸ë±ìŠ¤ë§Œìœ¼ë¡œ ì¡°íšŒ) | âœ… ìµœì  |
| **Using where** | WHERE ì ˆ í•„í„°ë§ ìˆ˜í–‰ | âš ï¸ ì¶”ê°€ ì‘ì—… |
| **Using temporary** | ì„ì‹œ í…Œì´ë¸” ì‚¬ìš© (GROUP BY, ORDER BY) | âš ï¸ ì¶”ê°€ ë¹„ìš© |
| **Using filesort** | íŒŒì¼ ì •ë ¬ ìˆ˜í–‰ (ORDER BY) | âš ï¸ ì¶”ê°€ ë¹„ìš© |

---

## ğŸ”® ì¶”ê°€ ìµœì í™” ê°€ëŠ¥ì„±

### 1. Covering Index ì¬ê²€í† 
4ë‹¨ê³„ ì‹¤í—˜ì—ì„œ Covering Indexê°€ ë” ëŠë ¸ì§€ë§Œ, ë‹¤ìŒ ê²½ìš°ì—” ì¬ê³ ë ¤ ê°€ëŠ¥:
```sql
-- ëŒ€ìš©ëŸ‰ ë°ì´í„° (ìˆ˜ë°±ë§Œ ê±´ ì´ìƒ)ì—ì„œ ì¬í…ŒìŠ¤íŠ¸
CREATE INDEX idx_order_items_covering
ON order_items(order_id, product_id, quantity);
```
**ì¬ê²€í†  ì¡°ê±´:**
- ì¡°ì¸ íšŸìˆ˜ê°€ ìˆ˜ì‹­ë§Œ ê±´ ì´ìƒì¼ ë•Œ
- í…Œì´ë¸” í¬ê¸°ê°€ ë²„í¼ í’€ì„ ì´ˆê³¼í•  ë•Œ
- ì½ê¸° ì „ìš© ì¿¼ë¦¬ê°€ ì••ë„ì ì¼ ë•Œ

### 2. ì¿¼ë¦¬ ìºì‹±
```java
@Cacheable(value = "popularProducts", key = "'last3days'")
public List<ProductResponse> getPopularProducts() {
    // 5ë¶„ TTLë¡œ ìºì‹±
}
```
â†’ 840ms â†’ ìˆ˜ msë¡œ ë‹¨ì¶•

### 3. ë³µí•© ì¸ë±ìŠ¤ ìµœì í™”
Left-most prefix ruleì„ í™œìš©í•œ ì¤‘ë³µ ì¸ë±ìŠ¤ ì œê±°:
```sql
-- í˜„ì¬: 2ê°œ ì¸ë±ìŠ¤
idx_orders_user_id (user_id)
idx_orders_user_id_status (user_id, status)

-- ìµœì í™”: 1ê°œ ì¸ë±ìŠ¤ë¡œ í†µí•© ê°€ëŠ¥
idx_orders_user_id_status (user_id, status)
-- â†’ user_id ë‹¨ë… ì¡°íšŒë„ ì´ ì¸ë±ìŠ¤ë¡œ ì»¤ë²„ë¨
```
**ì¥ì :**
- ì¸ë±ìŠ¤ ê°œìˆ˜ ê°ì†Œ (ê´€ë¦¬ ë¶€ë‹´ ê°ì†Œ)
- INSERT/UPDATE ì‹œ ì¸ë±ìŠ¤ ê°±ì‹  íšŸìˆ˜ ê°ì†Œ
- ìŠ¤í† ë¦¬ì§€ ê³µê°„ ì ˆì•½

### 4. ì¸ë±ìŠ¤ ìœ ì§€ë³´ìˆ˜
```sql
-- ì¸ë±ìŠ¤ í†µê³„ ê°±ì‹ 
ANALYZE TABLE orders;
ANALYZE TABLE order_items;

-- ì¸ë±ìŠ¤ ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§
SHOW INDEX FROM orders;

-- ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì¸ë±ìŠ¤ í™•ì¸
SELECT * FROM sys.schema_unused_indexes;
```
â†’ ì˜µí‹°ë§ˆì´ì €ê°€ ìµœì‹  í†µê³„ë¡œ ìµœì  ì‹¤í–‰ ê³„íš ìˆ˜ë¦½

### 5. íŒŒí‹°ì…”ë‹ ê³ ë ¤ (ëŒ€ìš©ëŸ‰ ë°ì´í„°)
```sql
-- created_at ê¸°ì¤€ íŒŒí‹°ì…”ë‹
ALTER TABLE orders PARTITION BY RANGE (YEAR(created_at)) (
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026)
);
```
â†’ ìµœê·¼ 3ì¼ ë°ì´í„°ë§Œ ìŠ¤ìº”, Old ë°ì´í„°ëŠ” ìë™ ìŠ¤í‚µ

---

## ğŸ—‚ï¸ ì¶”ê°€ ì¸ë±ìŠ¤ ì„¤ê³„

ì¸ê¸° ìƒí’ˆ ì¡°íšŒ ì™¸ì—ë„ ë‹¤ë¥¸ ì£¼ìš” ì¿¼ë¦¬ë“¤ì„ ìœ„í•œ ì¸ë±ìŠ¤ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

### 1. orders í…Œì´ë¸” - ì‚¬ìš©ìë³„ ì£¼ë¬¸ ì¡°íšŒ

```sql
-- ì‚¬ìš©ì ID + ìƒíƒœë¡œ ì£¼ë¬¸ ì¡°íšŒ
CREATE INDEX idx_orders_user_id_status ON orders(user_id, status);
```

**ìµœì í™” ëŒ€ìƒ ì¿¼ë¦¬:**
- `findByUserId(String userId)` - ë§ˆì´í˜ì´ì§€ ì£¼ë¬¸ ë‚´ì—­
- `findByUserIdAndStatus(String userId, OrderStatus status)` - íŠ¹ì • ìƒíƒœ ì£¼ë¬¸ ì¡°íšŒ

**ì„¤ê³„ ì´ìœ :**
- ë³µí•© ì¸ë±ìŠ¤ í•˜ë‚˜ë¡œ ë‘ ì¿¼ë¦¬ ëª¨ë‘ ìµœì í™”
- Left-most prefix rule: `(user_id, status)` ì¸ë±ìŠ¤ëŠ” `user_id` ë‹¨ë… ì¡°íšŒë„ ì§€ì›
- ì¤‘ë³µ ì¸ë±ìŠ¤ ì œê±°ë¡œ INSERT/UPDATE ì„±ëŠ¥ í–¥ìƒ
- í˜ì´ì§• ì¿¼ë¦¬ ì„±ëŠ¥ í–¥ìƒ

**âŒ ì˜ëª»ëœ ì„¤ê³„ (ì¤‘ë³µ ì¸ë±ìŠ¤):**
```sql
-- ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¨!
CREATE INDEX idx_orders_user_id ON orders(user_id);              -- ì¤‘ë³µ!
CREATE INDEX idx_orders_user_id_status ON orders(user_id, status); -- ì´ê²ƒë§Œ ìˆìœ¼ë©´ ë¨
```

---

### 2. products í…Œì´ë¸” - ìƒí’ˆ ê²€ìƒ‰ ë° ì •ë ¬

```sql
-- ì¹´í…Œê³ ë¦¬ + ê°€ê²© ì •ë ¬
CREATE INDEX idx_products_category_price ON products(category, price);
```

**ìµœì í™” ëŒ€ìƒ ì¿¼ë¦¬:**
- `findByCategory(String category)` - ì¹´í…Œê³ ë¦¬ë³„ ìƒí’ˆ ëª©ë¡
- `findByCategoryOrderByPriceAsc(String category)` - ì¹´í…Œê³ ë¦¬ ë‚´ ê°€ê²©ìˆœ ì •ë ¬

**ì„¤ê³„ ì´ìœ :**
- ì¹´í…Œê³ ë¦¬ í•„í„°ë§ í›„ ê°€ê²© ì •ë ¬ì„ ì¸ë±ìŠ¤ë¡œ ì²˜ë¦¬
- ORDER BY price ì‚¬ìš© ì‹œ filesort ë°©ì§€
- ë³µí•© ì¸ë±ìŠ¤ë¡œ Covering Index íš¨ê³¼

---

### 3. user_coupons í…Œì´ë¸” - ì¤‘ë³µ ë°œê¸‰ ë°©ì§€

```sql
-- ì‚¬ìš©ì + ì¿ í° ë³µí•© ì¸ë±ìŠ¤ (ì¤‘ë³µ ì²´í¬ìš©)
CREATE INDEX idx_user_coupons_user_coupon ON user_coupons(user_id, coupon_id);
```

**ìµœì í™” ëŒ€ìƒ ì¿¼ë¦¬:**
- `existsByUserIdAndCouponId(String userId, String couponId)` - **ì¤‘ë³µ ë°œê¸‰ ì²´í¬ (ì¤‘ìš”!)**
- `existsByUserIdAndCouponIdWithLock()` - ë¹„ê´€ì  ë½(SELECT FOR UPDATE)
- `findByUserId(String userId)` - ì‚¬ìš©ì ë³´ìœ  ì¿ í° ëª©ë¡

**ì„¤ê³„ ì´ìœ :**
- ì¿ í° ì¤‘ë³µ ë°œê¸‰ ë°©ì§€ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ í•µì‹¬
- ë™ì‹œì„± ì œì–´(ë¹„ê´€ì  ë½) ì‚¬ìš© ì‹œ ì¸ë±ìŠ¤ í•„ìˆ˜
- user_id + coupon_id ì¡°í•©ìœ¼ë¡œ ë¹ ë¥¸ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
- Left-most prefix rule: `(user_id, coupon_id)` ì¸ë±ìŠ¤ëŠ” `user_id` ë‹¨ë… ì¡°íšŒë„ ì§€ì›

**âŒ ì˜ëª»ëœ ì„¤ê³„ (ì¤‘ë³µ ì¸ë±ìŠ¤):**
```sql
-- ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¨!
CREATE INDEX idx_user_coupons_user_id ON user_coupons(user_id);              -- ì¤‘ë³µ!
CREATE INDEX idx_user_coupons_user_coupon ON user_coupons(user_id, coupon_id); -- ì´ê²ƒë§Œ ìˆìœ¼ë©´ ë¨
```

---

### ğŸ“‹ ìµœì¢… ì¸ë±ìŠ¤ ëª©ë¡

| í…Œì´ë¸” | ì¸ë±ìŠ¤ëª… | ì»¬ëŸ¼ | ìš©ë„ | Left-most í™œìš© |
|--------|---------|------|------|---------------|
| orders | idx_orders_status_created_at | (status, created_at) | ì¸ê¸° ìƒí’ˆ ì¡°íšŒ | status ë‹¨ë… ì¡°íšŒë„ ì§€ì› |
| orders | idx_orders_user_id_status | (user_id, status) | ì‚¬ìš©ìë³„ ì£¼ë¬¸ ì¡°íšŒ | user_id ë‹¨ë… ì¡°íšŒë„ ì§€ì› âœ… |
| order_items | idx_order_items_order_id | (order_id) | ordersì™€ JOIN | - |
| order_items | idx_order_items_product_id | (product_id) | productsì™€ JOIN | - |
| products | idx_products_category_price | (category, price) | ì¹´í…Œê³ ë¦¬ë³„ ì •ë ¬ | category ë‹¨ë… ì¡°íšŒë„ ì§€ì› |
| user_coupons | idx_user_coupons_user_coupon | (user_id, coupon_id) | ì¤‘ë³µ ë°œê¸‰ ë°©ì§€ | user_id ë‹¨ë… ì¡°íšŒë„ ì§€ì› âœ… |

**ì´ 6ê°œì˜ ì¸ë±ìŠ¤ (PRIMARY KEY ì œì™¸)**

**ì¤‘ë³µ ì¸ë±ìŠ¤ ì œê±°:**
- âŒ `idx_orders_user_id` ì œê±° â†’ `idx_orders_user_id_status`ë¡œ ì»¤ë²„
- âŒ `idx_user_coupons_user_id` ì œê±° â†’ `idx_user_coupons_user_coupon`ìœ¼ë¡œ ì»¤ë²„

**ê°œì„  íš¨ê³¼:**
- ì¸ë±ìŠ¤ ê°œìˆ˜: 8ê°œ â†’ 6ê°œ (25% ê°ì†Œ)
- INSERT/UPDATE ì‹œ ì¸ë±ìŠ¤ ê°±ì‹  íšŸìˆ˜ ê°ì†Œ
- ìŠ¤í† ë¦¬ì§€ ê³µê°„ ì ˆì•½
- ë™ì¼í•œ ì¿¼ë¦¬ ì„±ëŠ¥ ìœ ì§€

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [MySQL 8.0 Reference Manual - EXPLAIN](https://dev.mysql.com/doc/refman/8.0/en/explain.html)
- [MySQL 8.0 Reference Manual - Optimization and Indexes](https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html)
- [High Performance MySQL](https://www.oreilly.com/library/view/high-performance-mysql/9781492080503/)
- [Use The Index, Luke! - A Guide To Database Performance](https://use-the-index-luke.com/)
---
